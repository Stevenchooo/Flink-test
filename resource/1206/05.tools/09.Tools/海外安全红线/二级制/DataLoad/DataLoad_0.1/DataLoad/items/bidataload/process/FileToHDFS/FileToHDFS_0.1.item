<?xml version="1.0" encoding="UTF-8"?>
<talendfile:ProcessType xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:talendfile="platform:/resource/org.talend.model/model/TalendFile.xsd" defaultContext="Default">
  <context confirmationNeeded="false" name="Default">
    <contextParameter comment="" name="rootDir" prompt="rootDir?" promptNeeded="false" type="id_String" value="null"/>
    <contextParameter comment="" name="tablename" prompt="tablename?" promptNeeded="false" type="id_String" value="null"/>
    <contextParameter comment="" name="hadoopdir" prompt="hadoopdir?" promptNeeded="false" type="id_String" value="null"/>
    <contextParameter comment="" name="partition" prompt="partition?" promptNeeded="false" type="id_String" value="null"/>
    <contextParameter comment="" name="tablelocation" prompt="tablelocation?" promptNeeded="false" type="id_String" value="null"/>
    <contextParameter comment="" name="multiInputFileConf" prompt="multiInputFileConf?" promptNeeded="false" type="id_Object" value=""/>
    <contextParameter comment="" name="commondInfo" prompt="commondInfo?" promptNeeded="false" type="id_Object" value=""/>
    <contextParameter comment="" name="partitionPositions" prompt="partitionPositions?" promptNeeded="false" type="id_Object" value=""/>
  </context>
  <parameters>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_X" value="0"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_Y" value="0"/>
    <elementParameter field="TEXT" name="REPOSITORY_CONNECTION_ID" value=""/>
    <elementParameter field="CHECK" name="IMPLICITCONTEXT_USE_PROJECT_SETTINGS" value="true"/>
    <elementParameter field="CHECK" name="STATANDLOG_USE_PROJECT_SETTINGS" value="true"/>
    <elementParameter field="CHECK" name="MULTI_THREAD_EXECATION" value="false"/>
    <elementParameter field="CHECK" name="IMPLICIT_TCONTEXTLOAD" value="false"/>
    <elementParameter field="RADIO" name="FROM_FILE_FLAG_IMPLICIT_CONTEXT" value="false"/>
    <elementParameter field="RADIO" name="FROM_DATABASE_FLAG_IMPLICIT_CONTEXT" value="false"/>
    <elementParameter field="FILE" name="IMPLICIT_TCONTEXTLOAD_FILE" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="FIELDSEPARATOR" value="&quot;&quot;"/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE_IMPLICIT_CONTEXT" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION_IMPLICIT_CONTEXT" value=""/>
    <elementParameter field="TEXT" name="URL_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR_IMPLICIT_CONTEXT"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="USER_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS_IMPLICIT_CONTEXT" value="0RMsyjmybrE="/>
    <elementParameter field="FILE" name="DBFILE_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="DBTABLE_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="QUERY_CONDITION_IMPLICIT_CONTEXT" value="&quot;&quot;"/>
    <elementParameter field="CLOSED_LIST" name="LOAD_NEW_VARIABLE" value="Warning"/>
    <elementParameter field="CLOSED_LIST" name="NOT_LOAD_OLD_VARIABLE" value="Warning"/>
    <elementParameter field="CHECK" name="PRINT_OPERATIONS" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_ERROR" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_WARNINGS" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_INFO" value="false"/>
    <elementParameter field="CHECK" name="ON_STATCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_LOGCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_METERCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_CONSOLE_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_FILES_FLAG" value="false"/>
    <elementParameter field="DIRECTORY" name="FILE_PATH" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace/.metadata&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_STATS" value="&quot;stats_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_LOGS" value="&quot;logs_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_METTER" value="&quot;meter_file.txt&quot;"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" value="ISO-8859-15"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="ON_DATABASE_FLAG" value="false"/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE" value="tJDBCOutput"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="ojdbc14-10g.jar"/>
    <elementParameter field="TEXT" name="URL" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DATASOURCE" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="USER" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" value="0RMsyjmybrE="/>
    <elementParameter field="FILE" name="DBFILE" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_STATS" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_LOGS" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_METER" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="CATCH_RUNTIME_ERRORS" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_ERRORS" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_WARNING" value="true"/>
    <elementParameter field="CHECK" name="CATCH_REALTIME_STATS" value="false"/>
    <elementParameter field="TEXT" name="HEADERFOOTER_HEADERID" value=""/>
    <elementParameter field="CHECK" name="HEADER_ENABLED" value="false"/>
    <elementParameter field="TEXT" name="HEADER_LIBRARY" value=""/>
    <elementParameter field="TEXT" name="HEADER_CODE" value=""/>
    <elementParameter field="TEXT" name="HEADER_IMPORT" value=""/>
    <elementParameter field="TEXT" name="HEADERFOOTER_FOOTERID" value=""/>
    <elementParameter field="CHECK" name="FOOTER_ENABLED" value="false"/>
    <elementParameter field="TEXT" name="FOOTER_LIBRARY" value=""/>
    <elementParameter field="TEXT" name="FOOTER_CODE" value=""/>
    <elementParameter field="TEXT" name="FOOTER_IMPORT" value=""/>
    <routinesParameter id="_j81p4AKEEeSeuZe1VRqQ1w" name="DataOperation"/>
    <routinesParameter id="_j9lQwAKEEeSeuZe1VRqQ1w" name="Mathematical"/>
    <routinesParameter id="_j9ntAAKEEeSeuZe1VRqQ1w" name="Numeric"/>
    <routinesParameter id="_j9o7IAKEEeSeuZe1VRqQ1w" name="Relational"/>
    <routinesParameter id="_j9qwUAKEEeSeuZe1VRqQ1w" name="StringHandling"/>
    <routinesParameter id="_j9slgAKEEeSeuZe1VRqQ1w" name="TalendDataGenerator"/>
    <routinesParameter id="_j9tzoAKEEeSeuZe1VRqQ1w" name="TalendDate"/>
    <routinesParameter id="_j9vo0AKEEeSeuZe1VRqQ1w" name="TalendString"/>
  </parameters>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="128" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_9"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="Logger logger = Logger.getLogger(jobName);&#xA;globalMap.put(&quot;logger&quot;, logger);&#xA;&#xA;MultiInputFileConfInfo multiInputFileConfInfo = (MultiInputFileConfInfo)context.multiInputFileConf;&#xA;&#xA;logger.debug(&quot;inputFileList=&quot; + multiInputFileConfInfo.getInputFileList());&#xA;logger.debug(&quot;inputFileMinCount=&quot; + multiInputFileConfInfo.getInputFileMinCount());&#xA;logger.debug(&quot;waitInputMinutes=&quot; + multiInputFileConfInfo.getWaitInputMinutes());&#xA;logger.debug(&quot;hadoopdir=&quot; + context.hadoopdir);&#xA;logger.debug(&quot;partition=&quot; + context.partition);&#xA;logger.debug(&quot;partitionPositions=&quot; + context.partitionPositions);&#xA;logger.debug(&quot;rootDir=&quot; + context.rootDir);&#xA;logger.debug(&quot;tablelocation=&quot; + context.tablelocation);&#xA;logger.debug(&quot;tablename=&quot; + context.tablename);&#xA;&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="import org.apache.log4j.Logger;&#xA;&#xA;import com.huawei.etl.dataload.conf.MultiInputFileConfInfo;&#xA;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_9"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="128" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_1"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="Logger logger = Logger.getLogger(jobName);&#xA;globalMap.put(&quot;logger&quot;, logger);&#xA;&#xA;MultiInputFileConfInfo multiInputFileConfInfo = (MultiInputFileConfInfo)context.multiInputFileConf;&#xA;&#xA;String inputFileList = multiInputFileConfInfo.getInputFileList();&#xA;String filePath = inputFileList.substring(0 , inputFileList.lastIndexOf('/'));&#xA;File fileParent = new File(filePath);&#xA;CommondInfo commondInfo = (CommondInfo)context.commondInfo;&#xA;&#xA;String inputFileName = inputFileList.substring(inputFileList.lastIndexOf('/') + 1 , inputFileList.length());&#xA;CycleFileFilter cycleFileFilter = new CycleFileFilter(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;inputFileName, &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;commondInfo.getStartTime(), &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;commondInfo.getCycleType(), &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;commondInfo.getCycleLength(),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;multiInputFileConfInfo.isDumpFileLoad());&#xA;boolean allDeleteFlag = context.partition.split(&quot;,&quot;)[0].equals(&quot;none&quot;);&#xA;boolean fileSkip = multiInputFileConfInfo.isFileSkip();&#xA;if (commondInfo.containsProperty(&quot;fileskip&quot;)) {&#xA;&#x9;fileSkip = commondInfo.getPropertyBoolean(&quot;fileskip&quot;);&#xA;}&#xA;boolean runFirst = true;&#xA;String userName = System.getProperty(&quot;user.name&quot;);&#xA;&#xA;int inputFileMinCount = multiInputFileConfInfo.getInputFileMinCount();&#xA;int waitInputMinutes = multiInputFileConfInfo.getWaitInputMinutes();&#xA;File[] files = null;&#xA;int totalFile = 0;&#xA;Calendar lastTime = Calendar.getInstance();&#xA;lastTime.set(Calendar.MINUTE, lastTime.get(Calendar.MINUTE) + waitInputMinutes);&#xA;&#xA;globalMap.put(&quot;inputFileMinCount&quot;, inputFileMinCount);&#xA;int counter = 0;&#xA;&#xA;&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="import java.io.File;&#xA;import java.util.Calendar;&#xA;import org.apache.log4j.Logger;&#xA;&#xA;import com.huawei.etl.dataload.conf.CommondInfo;&#xA;import com.huawei.etl.dataload.conf.MultiInputFileConfInfo;&#xA;import com.huawei.etl.dataload.conf.CommondInfo.Cycletype;&#xA;import com.huawei.etl.dataload.util.CycleFileFilter;&#xA;import com.huawei.etl.dataload.util.ExportException;&#xA;import com.huawei.etl.dataload.util.ExportException.ReturnCode;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_1"/>
  </node>
  <node componentName="tLoop" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="256" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tLoop_3"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="RADIO" name="FORLOOP" value="false"/>
    <elementParameter field="RADIO" name="WHILELOOP" value="true"/>
    <elementParameter field="TEXT" name="FROM" value="1"/>
    <elementParameter field="TEXT" name="TO" value="10"/>
    <elementParameter field="TEXT" name="STEP" value="1"/>
    <elementParameter field="CHECK" name="INCREASE" value="true"/>
    <elementParameter field="TEXT" name="DECLARATION" value=""/>
    <elementParameter field="TEXT" name="CONDITION" value="true"/>
    <elementParameter field="TEXT" name="ITERATION" value=""/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="416" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_10"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="files = fileParent.listFiles(cycleFileFilter);&#xA;if (files == null) {&#xA;&#x9;files = new File[0];&#xA;}&#xA;totalFile = totalFile + files.length;&#xA;&#xA;counter++;&#xA;if (counter > 120) {&#xA;&#x9;counter = 0;&#xA;&#x9;logger.info(Calendar.getInstance().getTime().toString() + &quot; running.&quot;);&#xA;}&#xA;&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="//import java.util.List;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_10"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="416" posY="416">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_13"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="&#xA;// 超时结束任务&#xA;Calendar nowTime = Calendar.getInstance();&#xA;if (nowTime.compareTo(lastTime) > 0) {&#xA;&#x9;logger.info(&quot;Job Exit because run time exceeds &quot; + waitInputMinutes + &quot; minutes.&quot;);&#xA;&#x9;// 处理文件小于配置文件个数&#xA;&#x9;// 或者配置文件个数无效时处理文件是0个    则报错文件未到达&#xA;&#x9;String errorMessage = null;&#xA;&#x9;if (totalFile &lt; inputFileMinCount) {&#xA;&#x9;&#x9;errorMessage = &quot;The number of files [&quot; + totalFile + &quot;] did not reach &quot; + inputFileMinCount;&#xA;&#x9;&#x9;logger.info(errorMessage);&#xA;&#x9;&#x9;// 1.超时后校验文件超时标志抛出异常&#xA;&#x9;&#x9;// 2.如果文件入库0个必报错&#xA;&#x9;&#x9;if (multiInputFileConfInfo.isTimeOutCheckFile() || totalFile == 0) {&#xA;&#x9;&#x9;&#x9;throw new ExportException(ReturnCode.ERRORCODE_EXCEED_NOFILE, errorMessage);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#x9;else if (inputFileMinCount &lt; 0 &amp;&amp; totalFile == 0) {&#xA;&#x9;&#x9;errorMessage = &quot;The number of files [&quot; + totalFile + &quot;] did not reach 1&quot;;&#xA;&#x9;&#x9;logger.info(errorMessage);&#xA;&#x9;&#x9;throw new ExportException(ReturnCode.ERRORCODE_EXCEED_NOFILE, errorMessage);&#xA;&#x9;}&#xA;&#x9;&#xA;&#x9;errorMessage = &quot;The number of files [&quot; + totalFile + &quot;].&quot;;&#xA;&#x9;logger.info(errorMessage);&#xA;&#x9;break;&#xA;}&#xA;// 处理文件个数达到结束任务&#xA;else if (inputFileMinCount >= 0 &amp;&amp; totalFile >= inputFileMinCount) {&#xA;&#x9;logger.info(&quot;Job Exit because Data file number exceeds &quot; + inputFileMinCount);&#xA;&#x9;globalMap.put(&quot;totalFile&quot;, totalFile);&#xA;&#x9;break;&#xA;}&#xA;&#xA;Thread.sleep(1000);"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value=""/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_13"/>
  </node>
  <node componentName="tLoop" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="544" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tLoop_1"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="RADIO" name="FORLOOP" value="false"/>
    <elementParameter field="RADIO" name="WHILELOOP" value="true"/>
    <elementParameter field="TEXT" name="FROM" value="1"/>
    <elementParameter field="TEXT" name="TO" value="10"/>
    <elementParameter field="TEXT" name="STEP" value="1"/>
    <elementParameter field="CHECK" name="INCREASE" value="true"/>
    <elementParameter field="TEXT" name="DECLARATION" value="int i=0"/>
    <elementParameter field="TEXT" name="CONDITION" value="i&lt;files.length"/>
    <elementParameter field="TEXT" name="ITERATION" value="i++"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="704" posY="224">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_2"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="File file = files[i];&#xA;String workPath = context.rootDir + &quot;/work/&quot; + UUID.randomUUID().toString() + &quot;/&quot;;&#xA;globalMap.put(&quot;file_workPath&quot;, workPath);&#xA;// 记录入库文件&#xA;FileStatus fileNameFlag = new FileStatus(file, false);&#xA;fileNameFlag.setFileconf(userName);&#xA;fileNameFlag.setBeginTime(System.currentTimeMillis());&#xA;&#xA;// 重命名和移动文件命令&#xA;String fileName = file.getName();&#xA;FileOperate fo = new FileOperate();&#xA;int fileColumns = multiInputFileConfInfo.getFileColumns();&#xA;String newFileName = fo.getNewFileName(fileName, fileColumns);&#xA;String command = fo.getExtractCommand(&#xA;&#x9;&#x9;&#x9;workPath + fileName, &#xA;&#x9;&#x9;&#x9;newFileName, &#xA;&#x9;&#x9;&#x9;fileColumns);&#xA;String newPath = workPath + newFileName;&#xA;String newLzoFileName = newFileName;&#xA;//if (!newFileName.endsWith(&quot;.lzo&quot;)) {&#xA;//&#x9;newLzoFileName = newLzoFileName + &quot;.lzo&quot;;&#xA;//}&#xA;&#xA;// 入库的分区&#xA;String partitionCon = &quot;&quot;;&#xA;// 入库的HDFS路径&#xA;StringBuilder partitionFile = new StringBuilder();&#xA;partitionFile.append(context.hadoopdir);&#xA;partitionFile.append(context.tablelocation);&#xA;if (!allDeleteFlag) {&#xA;&#xA;&#x9;String partitionMerge = DateUtil.getPartitionFromFileName(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;fileName, &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;context.partition,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(int[])context.partitionPositions);&#xA;&#x9;partitionFile.append(partitionMerge);&#xA;&#x9;partitionCon = &quot; partition(&quot; + partitionMerge.replace(&quot;/&quot;, &quot;,&quot;).substring(1) + &quot;)&quot;;&#xA;}&#xA;&#xA;partitionFile.append('/');&#xA;partitionFile.append(newLzoFileName);&#xA;&#xA;&#xA;&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="import java.io.File;&#xA;import java.util.UUID;&#xA;import com.huawei.etl.dataload.util.CounterUtil;&#xA;import com.huawei.etl.dataload.util.CounterUtil.FileStatus;&#xA;import com.huawei.etl.dataload.util.FileOperate;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_2"/>
  </node>
  <node componentName="tSystem" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="832" posY="224">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tSystem_5"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="CHECK" name="ROOTDIR" value="false"/>
    <elementParameter field="DIRECTORY" name="DIRECTORY" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace&quot;"/>
    <elementParameter field="RADIO" name="USE_SINGLE_COMMAND" value="true"/>
    <elementParameter field="MEMO_JAVA" name="COMMAND" value="new String[]{&quot;/bin/sh&quot;,&quot;-c&quot;, &quot;hadoop fs -test -e &quot; + partitionFile.toString()}"/>
    <elementParameter field="RADIO" name="USE_ARRAY_COMMAND" value="false"/>
    <elementParameter field="TABLE" name="ARRAY_COMMAND"/>
    <elementParameter field="CLOSED_LIST" name="OUTPUT" value="RETRIEVE_OUTPUT"/>
    <elementParameter field="CLOSED_LIST" name="ERROROUTPUT" value="OUTPUT_TO_CONSOLE"/>
    <elementParameter field="TABLE" name="PARAMS"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tSystem_5"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="704" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_26"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="// 文件是否在hdfs中存在&#xA;boolean fileExist = ((Integer)globalMap.get(&quot;tSystem_5_EXIT_VALUE&quot;)).equals(0);&#xA;&#xA;&#xA;// 如果需要跳过重名文件，则不处理  或者 如果是空文件，则不入库，直接统计成已经入库&#xA;if ((fileSkip &amp;&amp; fileExist) || (file.length() == 0)) {&#xA;&#x9;fileNameFlag.setFileSkip(true);&#xA;&#x9;CounterUtil.counterSuccess(globalMap, fileNameFlag);&#xA;&#x9;i++;&#xA;&#x9;continue;&#xA;}&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="//import java.util.List;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_26"/>
  </node>
  <node componentName="tFileCopy" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="832" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tFileCopy_1"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="FILE" name="FILENAME" value="file.getAbsolutePath()"/>
    <elementParameter field="CHECK" name="ENABLE_COPY_DIRECTORY" value="false"/>
    <elementParameter field="DIRECTORY" name="SOURCE_DERECTORY" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace&quot;"/>
    <elementParameter field="DIRECTORY" name="DESTINATION" value="workPath"/>
    <elementParameter field="CHECK" name="RENAME" value="false"/>
    <elementParameter field="TEXT" name="DESTINATION_RENAME" value="&quot;NewName.temp&quot;"/>
    <elementParameter field="CHECK" name="REMOVE_FILE" value="false"/>
    <elementParameter field="CHECK" name="REPLACE_FILE" value="true"/>
    <elementParameter field="CHECK" name="CREATE_DIRECTORY" value="true"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tFileCopy_1"/>
  </node>
  <node componentName="tSystem" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="704" posY="416">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tSystem_1"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="CHECK" name="ROOTDIR" value="false"/>
    <elementParameter field="DIRECTORY" name="DIRECTORY" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace&quot;"/>
    <elementParameter field="RADIO" name="USE_SINGLE_COMMAND" value="true"/>
    <elementParameter field="MEMO_JAVA" name="COMMAND" value="new String[]{&quot;/bin/sh&quot;,&quot;-c&quot;, command}"/>
    <elementParameter field="RADIO" name="USE_ARRAY_COMMAND" value="false"/>
    <elementParameter field="TABLE" name="ARRAY_COMMAND"/>
    <elementParameter field="CLOSED_LIST" name="OUTPUT" value="OUTPUT_TO_CONSOLE"/>
    <elementParameter field="CLOSED_LIST" name="ERROROUTPUT" value="OUTPUT_TO_CONSOLE"/>
    <elementParameter field="TABLE" name="PARAMS"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tSystem_1"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="704" posY="480">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_19"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="if (!((Integer)globalMap.get(&quot;tSystem_1_EXIT_VALUE&quot;)).equals(0)) {&#xA;&#x9;throw new ExportException(ReturnCode.ERRORCODE_FILE_CREATE_ERROR, fileName + &quot;  extract file or rename error.&quot;);&#xA;}&#xA;&#xA;if (fo.isErrorFile(newPath, &#xA;                   fileColumns,&#xA;                   multiInputFileConfInfo.getSeparator())) {&#xA;    CounterUtil.counterError(globalMap, fileNameFlag);&#xA;&#x9;throw new ExportException(ReturnCode.ERRORCODE_FILE_DATA_ERROR, fileName + &quot; columns is illegal.&quot;);&#xA;}"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="//import java.util.List;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_19"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="704" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_4"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="import com.huawei.etl.dataload.conf.MultiInputFileConfInfo;&#xA;import com.huawei.etl.dataload.util.ExportException;&#xA;import com.huawei.etl.dataload.util.ExportException.ReturnCode;&#xA;import com.huawei.etl.dataload.util.DateUtil;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_4"/>
  </node>
  <node componentName="tRunJob" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="832" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tRunJob_1"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="CHECK" name="USE_DYNAMIC_JOB" value="false"/>
    <elementParameter field="TEXT" name="CONTEXT_JOB" value=""/>
    <elementParameter field="PROCESS_TYPE" name="PROCESS" value="SingleFileToHDFS"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_PROCESS" value="_DY9GYAvkEeSHJeekvtAe5w"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_VERSION" value="Latest"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_CONTEXT" value="Default"/>
    <elementParameter field="TEXT" name="CONTEXT_NAME" value="Default"/>
    <elementParameter field="CHECK" name="USE_INDEPENDENT_PROCESS" value="false"/>
    <elementParameter field="CHECK" name="DIE_ON_CHILD_ERROR" value="false"/>
    <elementParameter field="CHECK" name="TRANSMIT_WHOLE_CONTEXT" value="false"/>
    <elementParameter field="TABLE" name="CONTEXTPARAMS">
      <elementValue elementRef="PARAM_NAME_COLUMN" value="inputFile"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="newPath"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="tablename"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="context.tablename"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="partition"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="partitionCon"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="partitionFile"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="partitionFile.toString()"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="runFirst"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="runFirst"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="allDeleteFlag"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="allDeleteFlag"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="inputFilePath"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="workPath"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="fileNameFlag"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="fileNameFlag"/>
      <elementValue elementRef="PARAM_NAME_COLUMN" value="fileExist"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="fileExist"/>
    </elementParameter>
    <elementParameter field="CHECK" name="PROPAGATE_CHILD_RESULT" value="false"/>
    <elementParameter field="CHECK" name="PRINT_PARAMETER" value="false"/>
    <elementParameter field="CHECK" name="TRANSMIT_ORIGINAL_CONTEXT" value="true"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tRunJob_1"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="704" posY="640">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_14"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="fileNameFlag.setEndTime(System.currentTimeMillis());&#xA;if (fileNameFlag.isStatus()) {&#xA;&#x9;CounterUtil.counterSuccess(globalMap, fileNameFlag);&#xA;}&#xA;else {&#xA;&#x9;CounterUtil.counterError(globalMap, fileNameFlag);&#xA;&#x9;throw new ExportException(ReturnCode.ERRORCODE_FILE_DATA_ERROR, &quot;file to hdfs error&quot;);&#xA;}&#xA;// 第一个文件入库后标记是否第一次入库&#xA;runFirst = false;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="//import java.util.List;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_14"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="128" posY="768">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_15"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="Logger logger = Logger.getLogger(jobName);&#xA;globalMap.put(&quot;logger&quot;, logger);&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="import com.huawei.etl.dataload.util.ExportException;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_15"/>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="288" posY="768">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_16"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="Logger logger = Logger.getLogger(jobName);&#xA;globalMap.put(&quot;logger&quot;, logger);&#xA;// 打印汇总日志&#xA;CounterUtil.logListFiles(globalMap);&#xA;String logFile = CounterUtil.getLogInfo(globalMap);&#xA;globalMap.put(&quot;logFile&quot;, logFile);&#xA;logger.info(&quot;Files load to HDFS end.&quot;);"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="import org.apache.commons.lang.StringUtils;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_16"/>
  </node>
  <node componentName="tLogCatcher" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="128" posY="902">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tLogCatcher_1"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="CHECK" name="CATCH_JAVA_EXCEPTION" value="true"/>
    <elementParameter field="CHECK" name="CATCH_TDIE" value="true"/>
    <elementParameter field="CHECK" name="CATCH_TWARN" value="true"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tLogCatcher_1">
      <column defaultValue="" key="false" length="0" name="moment" nullable="true" pattern="&quot;yyyy-MM-dd HH:mm:ss&quot;" precision="0" sourceType="" type="id_Date" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="root_pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="father_pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="50" name="project" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="job" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="50" name="context" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="3" name="priority" nullable="true" precision="0" sourceType="" type="id_Integer" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="type" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="origin" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="message" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="3" name="code" nullable="true" precision="0" sourceType="" type="id_Integer" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tJava" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="288" posY="899">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_17"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="// 打印汇总日志&#xA;CounterUtil.logListFiles(globalMap);&#xA;String logFile = CounterUtil.getLogInfo(globalMap);&#xA;globalMap.put(&quot;logFile&quot;, logFile);&#xA;&#xA;&#xA;"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="import org.apache.commons.lang.StringUtils;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJava_17">
      <column defaultValue="" key="false" length="0" name="moment" nullable="true" pattern="&quot;yyyy-MM-dd HH:mm:ss&quot;" precision="0" sourceType="" type="id_Date" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="root_pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="father_pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="50" name="project" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="job" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="50" name="context" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="3" name="priority" nullable="true" precision="0" sourceType="" type="id_Integer" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="type" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="origin" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="message" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="3" name="code" nullable="true" precision="0" sourceType="" type="id_Integer" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tSystem" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="480" posY="768">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tSystem_3"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="CHECK" name="ROOTDIR" value="false"/>
    <elementParameter field="DIRECTORY" name="DIRECTORY" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace&quot;"/>
    <elementParameter field="RADIO" name="USE_SINGLE_COMMAND" value="true"/>
    <elementParameter field="MEMO_JAVA" name="COMMAND" value="new String[]{&quot;/bin/sh&quot;,&quot;-c&quot;, (String)globalMap.get(&quot;logFile&quot;)}"/>
    <elementParameter field="RADIO" name="USE_ARRAY_COMMAND" value="false"/>
    <elementParameter field="TABLE" name="ARRAY_COMMAND"/>
    <elementParameter field="CLOSED_LIST" name="OUTPUT" value="OUTPUT_TO_CONSOLE"/>
    <elementParameter field="CLOSED_LIST" name="ERROROUTPUT" value="OUTPUT_TO_CONSOLE"/>
    <elementParameter field="TABLE" name="PARAMS"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tSystem_3"/>
  </node>
  <node componentName="tSystem" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="480" posY="899">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tSystem_4"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="CHECK" name="ROOTDIR" value="false"/>
    <elementParameter field="DIRECTORY" name="DIRECTORY" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace&quot;"/>
    <elementParameter field="RADIO" name="USE_SINGLE_COMMAND" value="true"/>
    <elementParameter field="MEMO_JAVA" name="COMMAND" value="new String[]{&quot;/bin/sh&quot;,&quot;-c&quot;, (String)globalMap.get(&quot;logFile&quot;)}"/>
    <elementParameter field="RADIO" name="USE_ARRAY_COMMAND" value="false"/>
    <elementParameter field="TABLE" name="ARRAY_COMMAND"/>
    <elementParameter field="CLOSED_LIST" name="OUTPUT" value="OUTPUT_TO_CONSOLE"/>
    <elementParameter field="CLOSED_LIST" name="ERROROUTPUT" value="OUTPUT_TO_CONSOLE"/>
    <elementParameter field="TABLE" name="PARAMS"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tSystem_4">
      <column defaultValue="" key="false" length="0" name="moment" nullable="true" pattern="&quot;yyyy-MM-dd HH:mm:ss&quot;" precision="0" sourceType="" type="id_Date" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="root_pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="20" name="father_pid" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="50" name="project" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="job" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="50" name="context" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="3" name="priority" nullable="true" precision="0" sourceType="" type="id_Integer" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="type" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="origin" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="message" nullable="true" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="3" name="code" nullable="true" precision="0" sourceType="" type="id_Integer" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tFileDelete" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="480" posY="1024">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tFileDelete_1"/>
    <elementParameter field="DIRECTORY" name="JAVA_LIBRARY_PATH" value="D:\Program\Talend\TOS_DI-Win32-20141207_1530-V5.6.1\configuration\lib\java"/>
    <elementParameter field="FILE" name="FILENAME" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace/in.csv&quot;"/>
    <elementParameter field="DIRECTORY" name="DIRECTORY" value="(String)globalMap.get(&quot;file_workPath&quot;)"/>
    <elementParameter field="TEXT" name="PATH" value="&quot;C:/Program Files/Talend/TOS_DI-Win32-r90681-V5.1.2/workspace/delete_folder or delete_file&quot;"/>
    <elementParameter field="CHECK" name="FAILON" value="false"/>
    <elementParameter field="CHECK" name="FOLDER" value="true"/>
    <elementParameter field="CHECK" name="FOLDER_FILE" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="*Note &quot;CURRENT_STATUS&quot; including:&#xA;&quot;File (or path) deleted.&quot;&#xA;&quot;No file (or path) deleted.&quot;&#xA;&quot;File (or path) does not exists or is invalid.&quot;"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tFileDelete_1"/>
  </node>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tJava_9" offsetLabelX="0" offsetLabelY="0" source="tJava_9" target="tJava_1">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnSubjobOk1"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tJava_1" offsetLabelX="0" offsetLabelY="0" source="tJava_1" target="tLoop_3">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate4"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tJava_1" offsetLabelX="0" offsetLabelY="0" source="tJava_1" target="tJava_15">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnSubjobOk2"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_3" offsetLabelX="0" offsetLabelY="0" outputId="1" source="tLoop_3" target="tJava_10">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate9"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_3" offsetLabelX="0" offsetLabelY="0" outputId="2" source="tLoop_3" target="tJava_13">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate8"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tJava_10" offsetLabelX="0" offsetLabelY="0" source="tJava_10" target="tLoop_1">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate6"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_1" offsetLabelX="0" offsetLabelY="0" outputId="1" source="tLoop_1" target="tJava_2">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate1"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_1" offsetLabelX="0" offsetLabelY="0" outputId="2" source="tLoop_1" target="tJava_26">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate3"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_1" offsetLabelX="0" offsetLabelY="0" outputId="3" source="tLoop_1" target="tSystem_1">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate5"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_1" offsetLabelX="0" offsetLabelY="0" outputId="4" source="tLoop_1" target="tJava_19">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate10"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_1" offsetLabelX="0" offsetLabelY="0" outputId="5" source="tLoop_1" target="tJava_4">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate11"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tLoop_1" offsetLabelX="0" offsetLabelY="0" outputId="6" source="tLoop_1" target="tJava_14">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate12"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tJava_2" offsetLabelX="0" offsetLabelY="0" source="tJava_2" target="tSystem_5">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate2"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tJava_26" offsetLabelX="0" offsetLabelY="0" source="tJava_26" target="tFileCopy_1">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate13"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="tJava_4" offsetLabelX="0" offsetLabelY="0" source="tJava_4" target="tRunJob_1">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate7"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tJava_15" offsetLabelX="0" offsetLabelY="0" source="tJava_15" target="tJava_16">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnSubjobOk3"/>
  </connection>
  <connection connectorName="RUN_IF" label="If" lineStyle="6" metaname="tJava_16" offsetLabelX="0" offsetLabelY="0" source="tJava_16" target="tSystem_3">
    <elementParameter field="MEMO_JAVA" name="CONDITION" value="StringUtils.isNotBlank((String)globalMap.get(&quot;logFile&quot;))"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="If1"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tLogCatcher_1" offsetLabelX="0" offsetLabelY="0" source="tLogCatcher_1" target="tJava_17">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnSubjobOk4"/>
  </connection>
  <connection connectorName="RUN_IF" label="If" lineStyle="6" metaname="tJava_17" offsetLabelX="0" offsetLabelY="0" outputId="1" source="tJava_17" target="tSystem_4">
    <elementParameter field="MEMO_JAVA" name="CONDITION" value="StringUtils.isNotBlank((String)globalMap.get(&quot;logFile&quot;))"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="If2"/>
  </connection>
  <connection connectorName="RUN_IF" label="If" lineStyle="6" metaname="tJava_17" offsetLabelX="0" offsetLabelY="0" outputId="2" source="tJava_17" target="tFileDelete_1">
    <elementParameter field="MEMO_JAVA" name="CONDITION" value="globalMap.get(&quot;file_workPath&quot;) != null"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="If3"/>
  </connection>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_9"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="作业初始化"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_15"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="判断任务状态"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_16"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="任务结束"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tLogCatcher_1"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="异常处理"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tJava_17"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="打印汇总日志"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tSystem_3"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tSystem_4"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tFileDelete_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
</talendfile:ProcessType>
