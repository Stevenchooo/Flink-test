DROP TABLE video.t_video_hvs_hours_watch_d_hbase;
CREATE EXTERNAL TABLE video.t_video_hvs_hours_watch_d_hbase
(
key string,
projectid string,
activitychannelid string,
contentid string,
dtime string,
vodwatch int,
h00vodwatch int,h01vodwatch int,h02vodwatch int,h03vodwatch int,
h04vodwatch int,h05vodwatch int,h06vodwatch int,h07vodwatch int,
h08vodwatch int,h09vodwatch int,h10vodwatch int,h11vodwatch int,
h12vodwatch int,h13vodwatch int,h14vodwatch int,h15vodwatch int,
h16vodwatch int,h17vodwatch int,h18vodwatch int,h19vodwatch int,
h20vodwatch int,h21vodwatch int,h22vodwatch int,h23vodwatch int,
ltvwatch int,
h00ltvwatch int,h01ltvwatch int,h02ltvwatch int,h03ltvwatch int,
h04ltvwatch int,h05ltvwatch int,h06ltvwatch int,h07ltvwatch int,
h08ltvwatch int,h09ltvwatch int,h10ltvwatch int,h11ltvwatch int,
h12ltvwatch int,h13ltvwatch int,h14ltvwatch int,h15ltvwatch int,
h16ltvwatch int,h17ltvwatch int,h18ltvwatch int,h19ltvwatch int,
h20ltvwatch int,h21ltvwatch int,h22ltvwatch int,h23ltvwatch int)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:CONTENTID,
indexvalue:DTIME,
indexvalue:VODWATCH,
indexvalue:H00VODWATCH,indexvalue:H01VODWATCH,
indexvalue:H02VODWATCH,indexvalue:H03VODWATCH,
indexvalue:H04VODWATCH,indexvalue:H05VODWATCH,
indexvalue:H06VODWATCH,indexvalue:H07VODWATCH,
indexvalue:H08VODWATCH,indexvalue:H09VODWATCH,
indexvalue:H10VODWATCH,indexvalue:H11VODWATCH,
indexvalue:H12VODWATCH,indexvalue:H13VODWATCH,
indexvalue:H14VODWATCH,indexvalue:H15VODWATCH,
indexvalue:H16VODWATCH,indexvalue:H17VODWATCH,
indexvalue:H18VODWATCH,indexvalue:H19VODWATCH,
indexvalue:H20VODWATCH,indexvalue:H21VODWATCH,
indexvalue:H22VODWATCH,indexvalue:H23VODWATCH,
indexvalue:LTVWATCH,
indexvalue:H00LTVWATCH,indexvalue:H01LTVWATCH,
indexvalue:H02LTVWATCH,indexvalue:H03LTVWATCH,
indexvalue:H04LTVWATCH,indexvalue:H05LTVWATCH,
indexvalue:H06LTVWATCH,indexvalue:H07LTVWATCH,
indexvalue:H08LTVWATCH,indexvalue:H09LTVWATCH,
indexvalue:H10LTVWATCH,indexvalue:H11LTVWATCH,
indexvalue:H12LTVWATCH,indexvalue:H13LTVWATCH,
indexvalue:H14LTVWATCH,indexvalue:H15LTVWATCH,
indexvalue:H16LTVWATCH,indexvalue:H17LTVWATCH,
indexvalue:H18LTVWATCH,indexvalue:H19LTVWATCH,
indexvalue:H20LTVWATCH,indexvalue:H21LTVWATCH,
indexvalue:H22LTVWATCH,indexvalue:H23LTVWATCH") 
TBLPROPERTIES ("hbase.table.name" = "t_video_hvs_hours_watch_d");
grant select,delete,insert on t_video_hvs_hours_watch_d_hbase to user mapred;
