<reportIndexGroup>
    <multiHqlReportIndexs>		
<!--
//设置周期为三天，即 观看时间 出现的情况是 跨两天
-->
		<!--  VOD 每天实际 观看用户数  watch -->
        <multiHqlReportIndex>
            <indexKey>video.hvs.hours.watch.vodwatchall.d</indexKey>
            <fieldName>vodwatch,h00vodwatch,h01vodwatch,h02vodwatch,h03vodwatch,h04vodwatch,h05vodwatch,h06vodwatch,h07vodwatch,h08vodwatch,h09vodwatch,h10vodwatch,h11vodwatch,h12vodwatch,h13vodwatch,h14vodwatch,h15vodwatch,h16vodwatch,h17vodwatch,h18vodwatch,h19vodwatch,h20vodwatch,h21vodwatch,h22vodwatch,h23vodwatch</fieldName>
            <hql>
                <![CDATA[
				select projectid,activitychannelid,contentid,dtime,
					   count(distinct(t.allusers)) vodwatch,
					   count(distinct(t.h00user)) h00vodwatch,
					   count(distinct(t.h01user)) h01vodwatch,
					   count(distinct(t.h02user)) h02vodwatch,
					   count(distinct(t.h03user)) h03vodwatch,
					   count(distinct(t.h04user)) h04vodwatch,
					   count(distinct(t.h05user)) h05vodwatch,
					   count(distinct(t.h06user)) h06vodwatch,
					   count(distinct(t.h07user)) h07vodwatch,
					   count(distinct(t.h08user)) h08vodwatch,
					   count(distinct(t.h09user)) h09vodwatch,
					   count(distinct(t.h10user)) h10vodwatch,
					   count(distinct(t.h11user)) h11vodwatch,
					   count(distinct(t.h12user)) h12vodwatch,
					   count(distinct(t.h13user)) h13vodwatch,
					   count(distinct(t.h14user)) h14vodwatch,
					   count(distinct(t.h15user)) h15vodwatch,
					   count(distinct(t.h16user)) h16vodwatch,
					   count(distinct(t.h17user)) h17vodwatch,
					   count(distinct(t.h18user)) h18vodwatch,
					   count(distinct(t.h19user)) h19vodwatch,
					   count(distinct(t.h20user)) h20vodwatch,
					   count(distinct(t.h21user)) h21vodwatch,
					   count(distinct(t.h22user)) h22vodwatch,
					   count(distinct(t.h23user)) h23vodwatch
				  from (select t1.projectid projectid,
							   if(t1.activitychannelid is null,'none',t1.activitychannelid) activitychannelid,
							   'ALL' contentid,
							   t2.dtime dtime,
							   if(t1.starthour = concat(t2.dtime,'00'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'00') and t1.endhour  >= concat(t2.dtime,'00'),t1.subscriberid,null)) h00user,
							   if(t1.starthour = concat(t2.dtime,'01'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'01') and t1.endhour  >= concat(t2.dtime,'01'),t1.subscriberid,null)) h01user,
							   if(t1.starthour = concat(t2.dtime,'02'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'02') and t1.endhour  >= concat(t2.dtime,'02'),t1.subscriberid,null)) h02user,
							   if(t1.starthour = concat(t2.dtime,'03'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'03') and t1.endhour  >= concat(t2.dtime,'03'),t1.subscriberid,null)) h03user,
							   if(t1.starthour = concat(t2.dtime,'04'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'04') and t1.endhour  >= concat(t2.dtime,'04'),t1.subscriberid,null)) h04user,
							   if(t1.starthour = concat(t2.dtime,'05'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'05') and t1.endhour  >= concat(t2.dtime,'05'),t1.subscriberid,null)) h05user,
							   if(t1.starthour = concat(t2.dtime,'06'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'06') and t1.endhour  >= concat(t2.dtime,'06'),t1.subscriberid,null)) h06user,
							   if(t1.starthour = concat(t2.dtime,'07'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'07') and t1.endhour  >= concat(t2.dtime,'07'),t1.subscriberid,null)) h07user,
							   if(t1.starthour = concat(t2.dtime,'08'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'08') and t1.endhour  >= concat(t2.dtime,'08'),t1.subscriberid,null)) h08user,
							   if(t1.starthour = concat(t2.dtime,'09'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'09') and t1.endhour  >= concat(t2.dtime,'09'),t1.subscriberid,null)) h09user,
							   if(t1.starthour = concat(t2.dtime,'10'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'10') and t1.endhour  >= concat(t2.dtime,'10'),t1.subscriberid,null)) h10user,
							   if(t1.starthour = concat(t2.dtime,'11'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'11') and t1.endhour  >= concat(t2.dtime,'11'),t1.subscriberid,null)) h11user,
							   if(t1.starthour = concat(t2.dtime,'12'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'12') and t1.endhour  >= concat(t2.dtime,'12'),t1.subscriberid,null)) h12user,
							   if(t1.starthour = concat(t2.dtime,'13'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'13') and t1.endhour  >= concat(t2.dtime,'13'),t1.subscriberid,null)) h13user,
							   if(t1.starthour = concat(t2.dtime,'14'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'14') and t1.endhour  >= concat(t2.dtime,'14'),t1.subscriberid,null)) h14user,
							   if(t1.starthour = concat(t2.dtime,'15'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'15') and t1.endhour  >= concat(t2.dtime,'15'),t1.subscriberid,null)) h15user,
							   if(t1.starthour = concat(t2.dtime,'16'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'16') and t1.endhour  >= concat(t2.dtime,'16'),t1.subscriberid,null)) h16user,
							   if(t1.starthour = concat(t2.dtime,'17'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'17') and t1.endhour  >= concat(t2.dtime,'17'),t1.subscriberid,null)) h17user,
							   if(t1.starthour = concat(t2.dtime,'18'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'18') and t1.endhour  >= concat(t2.dtime,'18'),t1.subscriberid,null)) h18user,
							   if(t1.starthour = concat(t2.dtime,'19'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'19') and t1.endhour  >= concat(t2.dtime,'19'),t1.subscriberid,null)) h19user,
							   if(t1.starthour = concat(t2.dtime,'20'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'20') and t1.endhour  >= concat(t2.dtime,'20'),t1.subscriberid,null)) h20user,
							   if(t1.starthour = concat(t2.dtime,'21'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'21') and t1.endhour  >= concat(t2.dtime,'21'),t1.subscriberid,null)) h21user,
							   if(t1.starthour = concat(t2.dtime,'22'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'22') and t1.endhour  >= concat(t2.dtime,'22'),t1.subscriberid,null)) h22user,
							   if(t1.starthour = concat(t2.dtime,'23'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'23') and t1.endhour  >= concat(t2.dtime,'23'),t1.subscriberid,null)) h23user,
							   t1.subscriberid allusers
						   from (select projectid,activitychannelid,t.date datatime,starttime,endtime,subscriberid,
										substr(t.starttime,0,10) starthour,
										substr(t.endtime,0,10) endhour,
										substr(t.endtime, 0, 8) dateendtime
								   from video.t_cdr_vod_watch_event t
								  where t.date >=from_unixtime(unix_timestamp(date_sub(from_unixtime(unix_timestamp('{STARTTIME}',
												'yyyyMMdd'),'yyyy-MM-dd'),3),'yyyy-MM-dd'),'yyyyMMddHHmmss')
									and t.date < '{ENDTIME}') t1,
								(select t.dtime
								   from video.t_bdi_muchtv_video_rundate t
								  where t.dtime > '{STARTTIME}' AND t.dtime < '{ENDTIME}') t2
						  where (t1.datatime < t2.dtime AND dateendtime >= t2.dtime)
							 or t1.datatime = t2.dtime
					union all
						select t1.projectid projectid,
							   'ALL' activitychannelid,
							   'ALL' contentid,
							   t2.dtime dtime,
							   if(t1.starthour = concat(t2.dtime,'00'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'00') and t1.endhour  >= concat(t2.dtime,'00'),t1.subscriberid,null)) h00user,
							   if(t1.starthour = concat(t2.dtime,'01'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'01') and t1.endhour  >= concat(t2.dtime,'01'),t1.subscriberid,null)) h01user,
							   if(t1.starthour = concat(t2.dtime,'02'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'02') and t1.endhour  >= concat(t2.dtime,'02'),t1.subscriberid,null)) h02user,
							   if(t1.starthour = concat(t2.dtime,'03'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'03') and t1.endhour  >= concat(t2.dtime,'03'),t1.subscriberid,null)) h03user,
							   if(t1.starthour = concat(t2.dtime,'04'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'04') and t1.endhour  >= concat(t2.dtime,'04'),t1.subscriberid,null)) h04user,
							   if(t1.starthour = concat(t2.dtime,'05'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'05') and t1.endhour  >= concat(t2.dtime,'05'),t1.subscriberid,null)) h05user,
							   if(t1.starthour = concat(t2.dtime,'06'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'06') and t1.endhour  >= concat(t2.dtime,'06'),t1.subscriberid,null)) h06user,
							   if(t1.starthour = concat(t2.dtime,'07'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'07') and t1.endhour  >= concat(t2.dtime,'07'),t1.subscriberid,null)) h07user,
							   if(t1.starthour = concat(t2.dtime,'08'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'08') and t1.endhour  >= concat(t2.dtime,'08'),t1.subscriberid,null)) h08user,
							   if(t1.starthour = concat(t2.dtime,'09'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'09') and t1.endhour  >= concat(t2.dtime,'09'),t1.subscriberid,null)) h09user,
							   if(t1.starthour = concat(t2.dtime,'10'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'10') and t1.endhour  >= concat(t2.dtime,'10'),t1.subscriberid,null)) h10user,
							   if(t1.starthour = concat(t2.dtime,'11'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'11') and t1.endhour  >= concat(t2.dtime,'11'),t1.subscriberid,null)) h11user,
							   if(t1.starthour = concat(t2.dtime,'12'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'12') and t1.endhour  >= concat(t2.dtime,'12'),t1.subscriberid,null)) h12user,
							   if(t1.starthour = concat(t2.dtime,'13'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'13') and t1.endhour  >= concat(t2.dtime,'13'),t1.subscriberid,null)) h13user,
							   if(t1.starthour = concat(t2.dtime,'14'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'14') and t1.endhour  >= concat(t2.dtime,'14'),t1.subscriberid,null)) h14user,
							   if(t1.starthour = concat(t2.dtime,'15'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'15') and t1.endhour  >= concat(t2.dtime,'15'),t1.subscriberid,null)) h15user,
							   if(t1.starthour = concat(t2.dtime,'16'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'16') and t1.endhour  >= concat(t2.dtime,'16'),t1.subscriberid,null)) h16user,
							   if(t1.starthour = concat(t2.dtime,'17'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'17') and t1.endhour  >= concat(t2.dtime,'17'),t1.subscriberid,null)) h17user,
							   if(t1.starthour = concat(t2.dtime,'18'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'18') and t1.endhour  >= concat(t2.dtime,'18'),t1.subscriberid,null)) h18user,
							   if(t1.starthour = concat(t2.dtime,'19'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'19') and t1.endhour  >= concat(t2.dtime,'19'),t1.subscriberid,null)) h19user,
							   if(t1.starthour = concat(t2.dtime,'20'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'20') and t1.endhour  >= concat(t2.dtime,'20'),t1.subscriberid,null)) h20user,
							   if(t1.starthour = concat(t2.dtime,'21'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'21') and t1.endhour  >= concat(t2.dtime,'21'),t1.subscriberid,null)) h21user,
							   if(t1.starthour = concat(t2.dtime,'22'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'22') and t1.endhour  >= concat(t2.dtime,'22'),t1.subscriberid,null)) h22user,
							   if(t1.starthour = concat(t2.dtime,'23'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'23') and t1.endhour  >= concat(t2.dtime,'23'),t1.subscriberid,null)) h23user,
							   t1.subscriberid allusers
						   from (select projectid,activitychannelid,t.date datatime,starttime,endtime,subscriberid,
										substr(t.starttime,0,10) starthour,
										substr(t.endtime,0,10) endhour,
										substr(t.endtime, 0, 8) dateendtime
								   from video.t_cdr_vod_watch_event t
								  where t.date >=from_unixtime(unix_timestamp(date_sub(from_unixtime(unix_timestamp('{STARTTIME}',
												'yyyyMMdd'),'yyyy-MM-dd'),3),'yyyy-MM-dd'),'yyyyMMddHHmmss')
									and t.date < '{ENDTIME}') t1,
								(select t.dtime
								   from video.t_bdi_muchtv_video_rundate t
								  where t.dtime > '{STARTTIME}' AND t.dtime < '{ENDTIME}') t2
						  where (t1.datatime < t2.dtime AND dateendtime >= t2.dtime)
							 or t1.datatime = t2.dtime
					)t
				group by projectid,activitychannelid,contentid,dtime
                ]]>
            </hql>
        </multiHqlReportIndex>
		
		<!--  每天实际 观看用户数  ltvwatch -->
        <multiHqlReportIndex>
            <indexKey>video.hvs.hours.watch.ltvwatchall.d</indexKey>
            <fieldName>ltvwatch,h00ltvwatch,h01ltvwatch,h02ltvwatch,h03ltvwatch,h04ltvwatch,h05ltvwatch,h06ltvwatch,h07ltvwatch,h08ltvwatch,h09ltvwatch,h10ltvwatch,h11ltvwatch,h12ltvwatch,h13ltvwatch,h14ltvwatch,h15ltvwatch,h16ltvwatch,h17ltvwatch,h18ltvwatch,h19ltvwatch,h20ltvwatch,h21ltvwatch,h22ltvwatch,h23ltvwatch</fieldName>
            <hql>
                <![CDATA[
				select projectid,activitychannelid,contentid,dtime,
					   count(distinct(t.allusers)) ltvwatch,
					   count(distinct(t.h00user)) h00ltvwatch,
					   count(distinct(t.h01user)) h01ltvwatch,
					   count(distinct(t.h02user)) h02ltvwatch,
					   count(distinct(t.h03user)) h03ltvwatch,
					   count(distinct(t.h04user)) h04ltvwatch,
					   count(distinct(t.h05user)) h05ltvwatch,
					   count(distinct(t.h06user)) h06ltvwatch,
					   count(distinct(t.h07user)) h07ltvwatch,
					   count(distinct(t.h08user)) h08ltvwatch,
					   count(distinct(t.h09user)) h09ltvwatch,
					   count(distinct(t.h10user)) h10ltvwatch,
					   count(distinct(t.h11user)) h11ltvwatch,
					   count(distinct(t.h12user)) h12ltvwatch,
					   count(distinct(t.h13user)) h13ltvwatch,
					   count(distinct(t.h14user)) h14ltvwatch,
					   count(distinct(t.h15user)) h15ltvwatch,
					   count(distinct(t.h16user)) h16ltvwatch,
					   count(distinct(t.h17user)) h17ltvwatch,
					   count(distinct(t.h18user)) h18ltvwatch,
					   count(distinct(t.h19user)) h19ltvwatch,
					   count(distinct(t.h20user)) h20ltvwatch,
					   count(distinct(t.h21user)) h21ltvwatch,
					   count(distinct(t.h22user)) h22ltvwatch,
					   count(distinct(t.h23user)) h23ltvwatch
				  from (select t1.projectid projectid,
							   if(t1.activitychannelid is null,'none',t1.activitychannelid) activitychannelid,
							   if(t1.contentid is null,'none',t1.contentid) contentid,
							   t2.dtime dtime,
							   if(t1.starthour = concat(t2.dtime,'00'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'00') and t1.endhour  >= concat(t2.dtime,'00'),t1.subscriberid,null)) h00user,
							   if(t1.starthour = concat(t2.dtime,'01'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'01') and t1.endhour  >= concat(t2.dtime,'01'),t1.subscriberid,null)) h01user,
							   if(t1.starthour = concat(t2.dtime,'02'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'02') and t1.endhour  >= concat(t2.dtime,'02'),t1.subscriberid,null)) h02user,
							   if(t1.starthour = concat(t2.dtime,'03'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'03') and t1.endhour  >= concat(t2.dtime,'03'),t1.subscriberid,null)) h03user,
							   if(t1.starthour = concat(t2.dtime,'04'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'04') and t1.endhour  >= concat(t2.dtime,'04'),t1.subscriberid,null)) h04user,
							   if(t1.starthour = concat(t2.dtime,'05'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'05') and t1.endhour  >= concat(t2.dtime,'05'),t1.subscriberid,null)) h05user,
							   if(t1.starthour = concat(t2.dtime,'06'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'06') and t1.endhour  >= concat(t2.dtime,'06'),t1.subscriberid,null)) h06user,
							   if(t1.starthour = concat(t2.dtime,'07'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'07') and t1.endhour  >= concat(t2.dtime,'07'),t1.subscriberid,null)) h07user,
							   if(t1.starthour = concat(t2.dtime,'08'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'08') and t1.endhour  >= concat(t2.dtime,'08'),t1.subscriberid,null)) h08user,
							   if(t1.starthour = concat(t2.dtime,'09'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'09') and t1.endhour  >= concat(t2.dtime,'09'),t1.subscriberid,null)) h09user,
							   if(t1.starthour = concat(t2.dtime,'10'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'10') and t1.endhour  >= concat(t2.dtime,'10'),t1.subscriberid,null)) h10user,
							   if(t1.starthour = concat(t2.dtime,'11'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'11') and t1.endhour  >= concat(t2.dtime,'11'),t1.subscriberid,null)) h11user,
							   if(t1.starthour = concat(t2.dtime,'12'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'12') and t1.endhour  >= concat(t2.dtime,'12'),t1.subscriberid,null)) h12user,
							   if(t1.starthour = concat(t2.dtime,'13'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'13') and t1.endhour  >= concat(t2.dtime,'13'),t1.subscriberid,null)) h13user,
							   if(t1.starthour = concat(t2.dtime,'14'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'14') and t1.endhour  >= concat(t2.dtime,'14'),t1.subscriberid,null)) h14user,
							   if(t1.starthour = concat(t2.dtime,'15'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'15') and t1.endhour  >= concat(t2.dtime,'15'),t1.subscriberid,null)) h15user,
							   if(t1.starthour = concat(t2.dtime,'16'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'16') and t1.endhour  >= concat(t2.dtime,'16'),t1.subscriberid,null)) h16user,
							   if(t1.starthour = concat(t2.dtime,'17'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'17') and t1.endhour  >= concat(t2.dtime,'17'),t1.subscriberid,null)) h17user,
							   if(t1.starthour = concat(t2.dtime,'18'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'18') and t1.endhour  >= concat(t2.dtime,'18'),t1.subscriberid,null)) h18user,
							   if(t1.starthour = concat(t2.dtime,'19'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'19') and t1.endhour  >= concat(t2.dtime,'19'),t1.subscriberid,null)) h19user,
							   if(t1.starthour = concat(t2.dtime,'20'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'20') and t1.endhour  >= concat(t2.dtime,'20'),t1.subscriberid,null)) h20user,
							   if(t1.starthour = concat(t2.dtime,'21'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'21') and t1.endhour  >= concat(t2.dtime,'21'),t1.subscriberid,null)) h21user,
							   if(t1.starthour = concat(t2.dtime,'22'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'22') and t1.endhour  >= concat(t2.dtime,'22'),t1.subscriberid,null)) h22user,
							   if(t1.starthour = concat(t2.dtime,'23'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'23') and t1.endhour  >= concat(t2.dtime,'23'),t1.subscriberid,null)) h23user,
							   t1.subscriberid allusers
						   from (select projectid,activitychannelid,t.logicalchannelid contentid,t.date datatime,starttime,endtime,subscriberid,
										substr(t.starttime,0,10) starthour,
										substr(t.endtime,0,10) endhour,
										substr(t.endtime,0,8) dateendtime
								   from video.t_cdr_livetv_watch_event t
								  where t.date >=from_unixtime(unix_timestamp(date_sub(from_unixtime(unix_timestamp('{STARTTIME}',
												'yyyyMMdd'),'yyyy-MM-dd'),3),'yyyy-MM-dd'),'yyyyMMddHHmmss')
									and t.date < '{ENDTIME}') t1,
								(select t.dtime
								   from video.t_bdi_muchtv_video_rundate t
								  where t.dtime > '{STARTTIME}' AND t.dtime < '{ENDTIME}') t2
						  where (t1.datatime < t2.dtime AND dateendtime >= t2.dtime)
							 or t1.datatime = t2.dtime
					union all
						select t1.projectid projectid,
							   'ALL' activitychannelid,
							   if(t1.contentid is null,'none',t1.contentid) contentid,
							   t2.dtime dtime,
							   if(t1.starthour = concat(t2.dtime,'00'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'00') and t1.endhour  >= concat(t2.dtime,'00'),t1.subscriberid,null)) h00user,
							   if(t1.starthour = concat(t2.dtime,'01'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'01') and t1.endhour  >= concat(t2.dtime,'01'),t1.subscriberid,null)) h01user,
							   if(t1.starthour = concat(t2.dtime,'02'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'02') and t1.endhour  >= concat(t2.dtime,'02'),t1.subscriberid,null)) h02user,
							   if(t1.starthour = concat(t2.dtime,'03'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'03') and t1.endhour  >= concat(t2.dtime,'03'),t1.subscriberid,null)) h03user,
							   if(t1.starthour = concat(t2.dtime,'04'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'04') and t1.endhour  >= concat(t2.dtime,'04'),t1.subscriberid,null)) h04user,
							   if(t1.starthour = concat(t2.dtime,'05'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'05') and t1.endhour  >= concat(t2.dtime,'05'),t1.subscriberid,null)) h05user,
							   if(t1.starthour = concat(t2.dtime,'06'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'06') and t1.endhour  >= concat(t2.dtime,'06'),t1.subscriberid,null)) h06user,
							   if(t1.starthour = concat(t2.dtime,'07'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'07') and t1.endhour  >= concat(t2.dtime,'07'),t1.subscriberid,null)) h07user,
							   if(t1.starthour = concat(t2.dtime,'08'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'08') and t1.endhour  >= concat(t2.dtime,'08'),t1.subscriberid,null)) h08user,
							   if(t1.starthour = concat(t2.dtime,'09'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'09') and t1.endhour  >= concat(t2.dtime,'09'),t1.subscriberid,null)) h09user,
							   if(t1.starthour = concat(t2.dtime,'10'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'10') and t1.endhour  >= concat(t2.dtime,'10'),t1.subscriberid,null)) h10user,
							   if(t1.starthour = concat(t2.dtime,'11'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'11') and t1.endhour  >= concat(t2.dtime,'11'),t1.subscriberid,null)) h11user,
							   if(t1.starthour = concat(t2.dtime,'12'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'12') and t1.endhour  >= concat(t2.dtime,'12'),t1.subscriberid,null)) h12user,
							   if(t1.starthour = concat(t2.dtime,'13'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'13') and t1.endhour  >= concat(t2.dtime,'13'),t1.subscriberid,null)) h13user,
							   if(t1.starthour = concat(t2.dtime,'14'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'14') and t1.endhour  >= concat(t2.dtime,'14'),t1.subscriberid,null)) h14user,
							   if(t1.starthour = concat(t2.dtime,'15'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'15') and t1.endhour  >= concat(t2.dtime,'15'),t1.subscriberid,null)) h15user,
							   if(t1.starthour = concat(t2.dtime,'16'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'16') and t1.endhour  >= concat(t2.dtime,'16'),t1.subscriberid,null)) h16user,
							   if(t1.starthour = concat(t2.dtime,'17'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'17') and t1.endhour  >= concat(t2.dtime,'17'),t1.subscriberid,null)) h17user,
							   if(t1.starthour = concat(t2.dtime,'18'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'18') and t1.endhour  >= concat(t2.dtime,'18'),t1.subscriberid,null)) h18user,
							   if(t1.starthour = concat(t2.dtime,'19'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'19') and t1.endhour  >= concat(t2.dtime,'19'),t1.subscriberid,null)) h19user,
							   if(t1.starthour = concat(t2.dtime,'20'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'20') and t1.endhour  >= concat(t2.dtime,'20'),t1.subscriberid,null)) h20user,
							   if(t1.starthour = concat(t2.dtime,'21'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'21') and t1.endhour  >= concat(t2.dtime,'21'),t1.subscriberid,null)) h21user,
							   if(t1.starthour = concat(t2.dtime,'22'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'22') and t1.endhour  >= concat(t2.dtime,'22'),t1.subscriberid,null)) h22user,
							   if(t1.starthour = concat(t2.dtime,'23'),t1.subscriberid,
							   if(t1.starthour < concat(t2.dtime,'23') and t1.endhour  >= concat(t2.dtime,'23'),t1.subscriberid,null)) h23user,
							   t1.subscriberid allusers
						   from (select projectid,activitychannelid,t.logicalchannelid contentid,t.date datatime,starttime,endtime,subscriberid,
										substr(t.starttime,0,10) starthour,
										substr(t.endtime,0,10) endhour,
										substr(t.endtime,0,8) dateendtime
								   from video.t_cdr_livetv_watch_event t
								  where t.date >=from_unixtime(unix_timestamp(date_sub(from_unixtime(unix_timestamp('{STARTTIME}',
												'yyyyMMdd'),'yyyy-MM-dd'),3),'yyyy-MM-dd'),'yyyyMMddHHmmss')
									and t.date < '{ENDTIME}') t1,
								(select t.dtime
								   from video.t_bdi_muchtv_video_rundate t
								  where t.dtime > '{STARTTIME}' AND t.dtime < '{ENDTIME}') t2
						  where (t1.datatime < t2.dtime AND dateendtime >= t2.dtime)
							 or t1.datatime = t2.dtime
					)t
				group by projectid,activitychannelid,contentid,dtime
                ]]>
            </hql>
        </multiHqlReportIndex>

    </multiHqlReportIndexs>
</reportIndexGroup>
