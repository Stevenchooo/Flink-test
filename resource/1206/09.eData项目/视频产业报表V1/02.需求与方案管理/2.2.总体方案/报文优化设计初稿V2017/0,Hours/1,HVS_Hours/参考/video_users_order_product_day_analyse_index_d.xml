<reportIndexGroup>
    <multiHqlReportIndexs>
		<!--  每天实际 观看用户数  orderproduct -->
        <multiHqlReportIndex>
            <indexKey>video.order.product.analyse.day.dayorderproduct.d</indexKey>
            <fieldName>orderproduct,h00orderproduct,h01orderproduct,h02orderproduct,h03orderproduct,h04orderproduct,h05orderproduct,h06orderproduct,h07orderproduct,h08orderproduct,h09orderproduct,h10orderproduct,h11orderproduct,h12orderproduct,h13orderproduct,h14orderproduct,h15orderproduct,h16orderproduct,h17orderproduct,h18orderproduct,h19orderproduct,h20orderproduct,h21orderproduct,h22orderproduct,h23orderproduct</fieldName>
            <hql>
                <![CDATA[
				select projectid,activitychannelid,dtime,
					   count(distinct(tt.allusers)) orderproduct,
					   count(distinct(tt.h00user)) h00orderproduct,
					   count(distinct(tt.h01user)) h01orderproduct,
					   count(distinct(tt.h02user)) h02orderproduct,
					   count(distinct(tt.h03user)) h03orderproduct,
					   count(distinct(tt.h04user)) h04orderproduct,
					   count(distinct(tt.h05user)) h05orderproduct,
					   count(distinct(tt.h06user)) h06orderproduct,
					   count(distinct(tt.h07user)) h07orderproduct,
					   count(distinct(tt.h08user)) h08orderproduct,
					   count(distinct(tt.h09user)) h09orderproduct,
					   count(distinct(tt.h10user)) h10orderproduct,
					   count(distinct(tt.h11user)) h11orderproduct,
					   count(distinct(tt.h12user)) h12orderproduct,
					   count(distinct(tt.h13user)) h13orderproduct,
					   count(distinct(tt.h14user)) h14orderproduct,
					   count(distinct(tt.h15user)) h15orderproduct,
					   count(distinct(tt.h16user)) h16orderproduct,
					   count(distinct(tt.h17user)) h17orderproduct,
					   count(distinct(tt.h18user)) h18orderproduct,
					   count(distinct(tt.h19user)) h19orderproduct,
					   count(distinct(tt.h20user)) h20orderproduct,
					   count(distinct(tt.h21user)) h21orderproduct,
					   count(distinct(tt.h22user)) h22orderproduct,
					   count(distinct(tt.h23user)) h23orderproduct
				  from (select t.projectid projectid,
							   if(t.activitychannelid is null,'none',t.activitychannelid) activitychannelid,
							   t.date dtime,
							   if(substr(t.time,0,10) = concat(t.date,'00'),t.identityid,null) h00user,
							   if(substr(t.time,0,10) = concat(t.date,'01'),t.identityid,null) h01user,
							   if(substr(t.time,0,10) = concat(t.date,'02'),t.identityid,null) h02user,
							   if(substr(t.time,0,10) = concat(t.date,'03'),t.identityid,null) h03user,
							   if(substr(t.time,0,10) = concat(t.date,'04'),t.identityid,null) h04user,
							   if(substr(t.time,0,10) = concat(t.date,'05'),t.identityid,null) h05user,
							   if(substr(t.time,0,10) = concat(t.date,'06'),t.identityid,null) h06user,
							   if(substr(t.time,0,10) = concat(t.date,'07'),t.identityid,null) h07user,
							   if(substr(t.time,0,10) = concat(t.date,'08'),t.identityid,null) h08user,
							   if(substr(t.time,0,10) = concat(t.date,'09'),t.identityid,null) h09user,
							   if(substr(t.time,0,10) = concat(t.date,'10'),t.identityid,null) h10user,
							   if(substr(t.time,0,10) = concat(t.date,'11'),t.identityid,null) h11user,
							   if(substr(t.time,0,10) = concat(t.date,'12'),t.identityid,null) h12user,
							   if(substr(t.time,0,10) = concat(t.date,'13'),t.identityid,null) h13user,
							   if(substr(t.time,0,10) = concat(t.date,'14'),t.identityid,null) h14user,
							   if(substr(t.time,0,10) = concat(t.date,'15'),t.identityid,null) h15user,
							   if(substr(t.time,0,10) = concat(t.date,'16'),t.identityid,null) h16user,
							   if(substr(t.time,0,10) = concat(t.date,'17'),t.identityid,null) h17user,
							   if(substr(t.time,0,10) = concat(t.date,'18'),t.identityid,null) h18user,
							   if(substr(t.time,0,10) = concat(t.date,'19'),t.identityid,null) h19user,
							   if(substr(t.time,0,10) = concat(t.date,'20'),t.identityid,null) h20user,
							   if(substr(t.time,0,10) = concat(t.date,'21'),t.identityid,null) h21user,
							   if(substr(t.time,0,10) = concat(t.date,'22'),t.identityid,null) h22user,
							   if(substr(t.time,0,10) = concat(t.date,'23'),t.identityid,null) h23user,
							   t.identityid allusers
						  from video.t_cdr_top_order_info t
						 where t.date > '{STARTTIME}' 
						   and t.date < '{ENDTIME}'
						   and (t.actiontype = 1 OR t.actiontype = 3)
					union all
						select t.projectid projectid,
							   'ALL' activitychannelid,
							   t.date dtime,
							   if(substr(t.time,0,10) = concat(t.date,'00'),t.identityid,null) h00user,
							   if(substr(t.time,0,10) = concat(t.date,'01'),t.identityid,null) h01user,
							   if(substr(t.time,0,10) = concat(t.date,'02'),t.identityid,null) h02user,
							   if(substr(t.time,0,10) = concat(t.date,'03'),t.identityid,null) h03user,
							   if(substr(t.time,0,10) = concat(t.date,'04'),t.identityid,null) h04user,
							   if(substr(t.time,0,10) = concat(t.date,'05'),t.identityid,null) h05user,
							   if(substr(t.time,0,10) = concat(t.date,'06'),t.identityid,null) h06user,
							   if(substr(t.time,0,10) = concat(t.date,'07'),t.identityid,null) h07user,
							   if(substr(t.time,0,10) = concat(t.date,'08'),t.identityid,null) h08user,
							   if(substr(t.time,0,10) = concat(t.date,'09'),t.identityid,null) h09user,
							   if(substr(t.time,0,10) = concat(t.date,'10'),t.identityid,null) h10user,
							   if(substr(t.time,0,10) = concat(t.date,'11'),t.identityid,null) h11user,
							   if(substr(t.time,0,10) = concat(t.date,'12'),t.identityid,null) h12user,
							   if(substr(t.time,0,10) = concat(t.date,'13'),t.identityid,null) h13user,
							   if(substr(t.time,0,10) = concat(t.date,'14'),t.identityid,null) h14user,
							   if(substr(t.time,0,10) = concat(t.date,'15'),t.identityid,null) h15user,
							   if(substr(t.time,0,10) = concat(t.date,'16'),t.identityid,null) h16user,
							   if(substr(t.time,0,10) = concat(t.date,'17'),t.identityid,null) h17user,
							   if(substr(t.time,0,10) = concat(t.date,'18'),t.identityid,null) h18user,
							   if(substr(t.time,0,10) = concat(t.date,'19'),t.identityid,null) h19user,
							   if(substr(t.time,0,10) = concat(t.date,'20'),t.identityid,null) h20user,
							   if(substr(t.time,0,10) = concat(t.date,'21'),t.identityid,null) h21user,
							   if(substr(t.time,0,10) = concat(t.date,'22'),t.identityid,null) h22user,
							   if(substr(t.time,0,10) = concat(t.date,'23'),t.identityid,null) h23user,
							   t.identityid allusers
						  from video.t_cdr_top_order_info t
						 where t.date > '{STARTTIME}' 
						   and t.date < '{ENDTIME}'
						   and (t.actiontype = 1 OR t.actiontype = 3)
					)tt
				group by projectid,activitychannelid,dtime
                ]]>
            </hql>
        </multiHqlReportIndex>

    </multiHqlReportIndexs>
</reportIndexGroup>
