DROP TABLE video.t_video_user_current_d_hbase;
CREATE EXTERNAL TABLE video.t_video_user_current_d_hbase
(key string,
projectid string,
activitychannelid string,
activityid string,
dtime string,
allregisteruser int,
newregisteruser int,
newcanceluser int,
totalregisteruser int,
wnewregisteruser int,
wnewcanceluser int,
woldtotaluser int,
wtotalregisteruser int,
mnewregisteruser int,
mnewcanceluser int,
moldtotaluser int,
mtotalregisteruser int)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:ACTIVITYID,
indexvalue:DTIME,
indexvalue:ALLREGISTERUSER,
indexvalue:NEWREGISTERUSER,
indexvalue:NEWCANCELUSER,
indexvalue:TOTALREGISTERUSER,
indexvalue:WNEWREGISTERUSER,
indexvalue:WNEWCANCELUSER,
indexvalue:WOLDTOTALUSER,
indexvalue:WTOTALREGISTERUSER,
indexvalue:MNEWREGISTERUSER,
indexvalue:MNEWCANCELUSER,
indexvalue:MOLDTOTALUSER,
indexvalue:MTOTALREGISTERUSER") 
TBLPROPERTIES ("hbase.table.name" = "t_video_user_current_d");
grant select,delete,insert on t_video_user_current_d_hbase to user mapred;
