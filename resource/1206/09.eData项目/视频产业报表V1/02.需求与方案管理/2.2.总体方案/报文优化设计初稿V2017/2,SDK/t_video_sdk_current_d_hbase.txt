DROP TABLE video.t_video_user_current_d_hbase;
CREATE EXTERNAL TABLE video.t_video_user_current_d_hbase
(key string,
projectid string,
activitychannelid string,
activityid string,
dtime string,
newvisitor int,
activeusers int,
registeruseractive int,
totalvisitor int,
wnewvisitor int,
wactiveusers int,
wregisteruseractive int,
mnewvisitor int,
mactiveusers int,
mregisteruseractive int)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:ACTIVITYID,
indexvalue:DTIME,
indexvalue:NEWVISITOR,
indexvalue:ACTIVEUSERS,
indexvalue:REGISTERUSERACTIVE,
indexvalue:TOTALVISITOR,
indexvalue:WNEWVISITOR,
indexvalue:WACTIVEUSERS,
indexvalue:WREGISTERUSERACTIVE,
indexvalue:MNEWVISITOR,
indexvalue:MACTIVEUSERS,
indexvalue:MREGISTERUSERACTIVE") 
TBLPROPERTIES ("hbase.table.name" = "t_video_user_current_d");
grant select,delete,insert on t_video_user_current_d_hbase to user mapred;
