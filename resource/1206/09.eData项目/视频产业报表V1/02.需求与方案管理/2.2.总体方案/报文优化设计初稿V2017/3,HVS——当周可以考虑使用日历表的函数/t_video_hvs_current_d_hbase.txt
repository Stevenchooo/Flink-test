DROP TABLE video.t_video_hvs_current_d_hbase;

CREATE EXTERNAL TABLE video.t_video_hvs_current_d_hbase
(key string,
projectid string,
activitychannelid string,
activityid string,
dtime string,
videosnumber int,vodtimes int,vodusers int,vodtime int,
vodpercapitatime double,vodpercapitaplay double,avgvodtime double,
wvideosnumber int,wvodtimes int,wvodusers int,wvodtime int,
wvodpercapitatime double,wvodpercapitaplay double,wavgvodtime double,
mvideosnumber int,mvodtimes int,mvodusers int,mvodtime int,
mvodpercapitatime double,mvodpercapitaplay double,mavgvodtime double,
livetimes int,liveusers int,livetime int,
livepercapitatime double,livepercapitaplay double,avglivetime double,
wlivetimes int,wliveusers int,wlivetime int,
wlivepercapitatime double,wlivepercapitaplay double,wavglivetime double,
mlivetimes int,mliveusers int,mlivetime int,
mlivepercapitatime double,mlivepercapitaplay double,mavglivetime double)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'

WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:ACTIVITYID,
indexvalue:DTIME,
indexvalue:VIDEOSNUMBER,
indexvalue:VODTIMES,
indexvalue:VODUSERS,
indexvalue:VODTIME,
indexvalue:VODPERCAPITATIME,
indexvalue:VODPERCAPITAPLAY,
indexvalue:AVGVODTIME,
indexvalue:WVIDEOSNUMBER,
indexvalue:WVODTIMES,
indexvalue:WVODUSERS,
indexvalue:WVODTIME,
indexvalue:WVODPERCAPITATIME,
indexvalue:WVODPERCAPITAPLAY,
indexvalue:WAVGVODTIME,
indexvalue:MVIDEOSNUMBER,
indexvalue:MVODTIMES,
indexvalue:MVODUSERS,
indexvalue:MVODTIME,
indexvalue:MVODPERCAPITATIME,
indexvalue:MVODPERCAPITAPLAY,
indexvalue:MAVGVODTIME,
indexvalue:LIVETIMES,
indexvalue:LIVEUSERS,
indexvalue:LIVETIME,
indexvalue:LIVEPERCAPITATIME,
indexvalue:LIVEPERCAPITAPLAY,
indexvalue:AVGLIVETIME,
indexvalue:WLIVETIMES,
indexvalue:WLIVEUSERS,
indexvalue:WLIVETIME,
indexvalue:WLIVEPERCAPITATIME,
indexvalue:WLIVEPERCAPITAPLAY,
indexvalue:WAVGLIVETIME,
indexvalue:MLIVETIMES,
indexvalue:MLIVEUSERS,
indexvalue:MLIVETIME,
indexvalue:MLIVEPERCAPITATIME,
indexvalue:MLIVEPERCAPITAPLAY,
indexvalue:MAVGLIVETIME") 
TBLPROPERTIES ("hbase.table.name" = "t_video_hvs_current_d");
grant select,delete,insert on t_video_hvs_current_d_hbase to user mapred;
