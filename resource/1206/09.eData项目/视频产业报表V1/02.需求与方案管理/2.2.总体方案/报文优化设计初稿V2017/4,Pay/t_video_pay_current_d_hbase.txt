DROP TABLE video.t_video_pay_current_d_hbase;

CREATE EXTERNAL TABLE video.t_video_pay_current_d_hbase
(key string,
projectid string,
activitychannelid string,
activityid string,
dtime string,
newincome double,
localnewincome double,
newpayuser int,
newclick double,
localnewclick double,
newclickuser int,
newsubscribe double,
localnewsubscribe double,
newsubscribeuser int,
yearallincome double,
localyearallincome double,
arpuincome double,
localarpuincome double,
wnewincome double,
wlocalnewincome double,
wnewpayuser int,
wnewclick double,
wlocalnewclick double,
wnewclickuser int,
wnewsubscribe double,
wlocalnewsubscribe double,
wnewsubscribeuser int,
warpuincome double,
wlocalarpuincome double,
mnewincome double,
mlocalnewincome double,
mnewpayuser int,
mnewclick double,
mlocalnewclick double,
mnewclickuser int,
mnewsubscribe double,
mlocalnewsubscribe double,
mnewsubscribeuser int,
marpuincome double,
mlocalarpuincome double)

STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'

WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:ACTIVITYID,
indexvalue:DTIME,
indexvalue:NEWINCOME,
indexvalue:LOCALNEWINCOME,
indexvalue:NEWCLICK,
indexvalue:LOCALNEWCLICK,
indexvalue:NEWCLICKUSER,
indexvalue:NEWSUBSCRIBE,
indexvalue:LOCALNEWSUBSCRIBE,
indexvalue:NEWSUBSCRIBEUSER,
indexvalue:YEARALLINCOME,
indexvalue:LOCALYEARALLINCOME,
indexvalue:ARPUINCOME,
indexvalue:LOCALARPUINCOME,
indexvalue:WNEWINCOME,
indexvalue:WLOCALNEWINCOME,
indexvalue:WNEWCLICK,
indexvalue:WLOCALNEWCLICK,
indexvalue:WNEWCLICKUSER,
indexvalue:WNEWSUBSCRIBE,
indexvalue:WLOCALNEWSUBSCRIBE,
indexvalue:WNEWSUBSCRIBEUSER,
indexvalue:WARPUINCOME,
indexvalue:WLOCALARPUINCOME,
indexvalue:MNEWINCOME,
indexvalue:MLOCALNEWINCOME,
indexvalue:MNEWCLICK,
indexvalue:MLOCALNEWCLICK,
indexvalue:MNEWCLICKUSER,
indexvalue:MNEWSUBSCRIBE,
indexvalue:MLOCALNEWSUBSCRIBE,
indexvalue:MNEWSUBSCRIBEUSER,
indexvalue:MARPUINCOME,
indexvalue:MLOCALARPUINCOME
") 
TBLPROPERTIES ("hbase.table.name" = "t_video_pay_current_d");
grant select,delete,insert on t_video_pay_current_d_hbase to user mapred;
