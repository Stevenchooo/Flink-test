DROP TABLE video.t_video_order_current_d_hbase;

CREATE EXTERNAL TABLE video.t_video_order_current_d_hbase
(key string,
projectid string,
activitychannelid string,
activityid string,
productid string,
dtime string,

productname string,
productcatalog string,
productordertype string,
allordertimes int,
allorderuser int,
newordertimes int,
neworderuser int,
loseordertimes int,
loseorderuser int,
orderuserproportion double,
freeexperienceuser int,
regularorderuser int,
totalorderpackageuser int,
totalloseorderuser int,
wnewordertimes int,
wneworderuser int,
wloseordertimes int,
wloseorderuser int,
wfreeexperienceuser int,
wregularorderuser int,
mnewordertimes int,
mneworderuser int,
mloseordertimes int,
mloseorderuser int)

STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'

WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:ACTIVITYID,
indexvalue:PRODUCTID,
indexvalue:DTIME,

indexvalue:PRODUCTNAME,
indexvalue:PRODUCTCATALOG,
indexvalue:PRODUCTORDERTYPE,
indexvalue:ALLORDERTIMES,
indexvalue:ALLORDERUSER,
indexvalue:NEWORDERTIMES,
indexvalue:NEWORDERUSER,
indexvalue:LOSEORDERTIMES,
indexvalue:LOSEORDERUSER,
indexvalue:ORDERUSERPROPORTION,
indexvalue:FREEEXPERIENCEUSER,
indexvalue:REGULARORDERUSER,
indexvalue:TOTALORDERPACKAGEUSER,
indexvalue:TOTALLOSEORDERUSER,
indexvalue:WNEWORDERTIMES,
indexvalue:WNEWORDERUSER,
indexvalue:WLOSEORDERTIMES,
indexvalue:WLOSEORDERUSER,
indexvalue:WFREEEXPERIENCEUSER,
indexvalue:WREGULARORDERUSER,
indexvalue:MNEWORDERTIMES,
indexvalue:MNEWORDERUSER,
indexvalue:MLOSEORDERTIMES,
indexvalue:MLOSEORDERUSER
") 
TBLPROPERTIES ("hbase.table.name" = "t_video_order_current_d");
grant select,delete,insert on t_video_order_current_d_hbase to user mapred;
