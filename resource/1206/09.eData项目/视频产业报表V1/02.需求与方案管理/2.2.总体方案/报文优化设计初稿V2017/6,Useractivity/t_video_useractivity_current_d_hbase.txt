DROP TABLE video.t_video_useractivity_current_d_hbase;

CREATE EXTERNAL TABLE video.t_video_useractivity_current_d_hbase
(key string,
projectid string,
activitychannelid string,
activityid string,
dtime string,

clickrate int,
cpaclickrate int,
cpcclickrate int,
conversionquantity int,
keyorderpromotion int,
keyregisterpromotion int,
wclickrate int,
wconversionquantity int,
wkeyorderpromotion int,
wkeyregisterpromotion int,
mclickrate int,
mcpaclickrate int,
mcpcclickrate int,
mconversionquantity int,
mkeyorderpromotion int,
mkeyregisterpromotion int)

STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'

WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:ACTIVITYID,
indexvalue:DTIME,

indexvalue:CLICKRATE,
indexvalue:CPACLICKRATE,
indexvalue:CPCCLICKRATE,
indexvalue:CONVERSIONQUANTITY,
indexvalue:KEYORDERPROMOTION,
indexvalue:KEYREGISTERPROMOTION,
indexvalue:WCLICKRATE,
indexvalue:WCONVERSIONQUANTITY,
indexvalue:WKEYORDERPROMOTION,
indexvalue:WKEYREGISTERPROMOTION,
indexvalue:MCLICKRATE,
indexvalue:MCPACLICKRATE,
indexvalue:MCPCCLICKRATE,
indexvalue:MCONVERSIONQUANTITY,
indexvalue:MKEYORDERPROMOTION,
indexvalue:MKEYREGISTERPROMOTION
") 
TBLPROPERTIES ("hbase.table.name" = "t_video_useractivity_current_d");
grant select,delete,insert on t_video_useractivity_current_d_hbase to user mapred;
