DROP TABLE video.t_video_sdk_flow_d_hbase;
CREATE EXTERNAL TABLE video.t_video_sdk_flow_d_hbase
(key string,
projectid string,
networktype string,
platformid string,
dtime string,
totalconsumeflow double,
flowprop double,
vodwatchusers int,
vodwatchflow double,
livetvwatchusers int,
livetvwatchflow double,
totalflowday double,
avgvodflow double,
avglivetvflow double,
wvodwatchusers int,
wvodwatchflow double,
wlivetvwatchusers int,
wlivetvwatchflow double,
wtotalflowday double,
wavgvodflow double,
wavglivetvflow double,
mvodwatchusers int,
mvodwatchflow double,
mlivetvwatchusers int,
mlivetvwatchflow double,
mtotalflowday double,
mavgvodflow double,
mavglivetvflow double)

STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'

WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:NETWORKTYPE,
indexvalue:PLATFORMID,
indexvalue:DTIME,
indexvalue:TOTALCONSUMEFLOW,
indexvalue:FLOWPROP,
indexvalue:VODWATCHUSERS,
indexvalue:VODWATCHFLOW,
indexvalue:LIVETVWATCHUSERS,
indexvalue:LIVETVWATCHFLOW,
indexvalue:TOTALFLOWDAY,
indexvalue:AVGVODFLOW,
indexvalue:AVGLIVETVFLOW,
indexvalue:WVODWATCHUSERS,
indexvalue:WVODWATCHFLOW,
indexvalue:WLIVETVWATCHUSERS,
indexvalue:WLIVETVWATCHFLOW,
indexvalue:WTOTALFLOWDAY,
indexvalue:WAVGVODFLOW,
indexvalue:WAVGLIVETVFLOW,
indexvalue:MVODWATCHUSERS,
indexvalue:MVODWATCHFLOW,
indexvalue:MLIVETVWATCHUSERS,
indexvalue:MLIVETVWATCHFLOW,
indexvalue:MTOTALFLOWDAY,
indexvalue:MAVGVODFLOW,
indexvalue:MAVGLIVETVFLOW") 
TBLPROPERTIES ("hbase.table.name" = "t_video_sdk_flow_d");

grant select,delete,insert on t_video_sdk_flow_d_hbase to user mapred;
