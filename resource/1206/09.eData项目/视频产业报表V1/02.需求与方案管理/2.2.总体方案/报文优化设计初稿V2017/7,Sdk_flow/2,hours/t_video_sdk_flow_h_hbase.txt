DROP TABLE video.t_video_sdk_flow_h_hbase;
CREATE EXTERNAL TABLE video.t_video_sdk_flow_h_hbase
(key string,
projectid string,
networktype string,
platformid string,
htime string,
hoursvoduser int,
hoursvodwatchflow double,
hourslivetvuser int,
hourslivetvwatchflow double,
totalflowhours double,
hourslivetvavgflow double,
hoursvodavgflow double,
whoursvoduser int,
whoursvodwatchflow double,
whourslivetvuser int,
whourslivetvwatchflow double,
wtotalflowhours double,
whourslivetvavgflow double,
whoursvodavgflow double)

STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'

WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:NETWORKTYPE,
indexvalue:PLATFORMID,
indexvalue:HTIME,
indexvalue:HOURSVODUSER,
indexvalue:HOURSVODWATCHFLOW,
indexvalue:HOURSLIVETVUSER,
indexvalue:HOURSLIVETVWATCHFLOW,
indexvalue:TOTALFLOWHOURS,,
indexvalue:HOURSLIVETVAVGFLOW,
indexvalue:HOURSVODAVGFLOW,
indexvalue:WHOURSVODUSER,
indexvalue:WHOURSVODWATCHFLOW,
indexvalue:WHOURSLIVETVUSER,
indexvalue:WHOURSLIVETVWATCHFLOW,
indexvalue:WTOTALFLOWHOURS,,
indexvalue:WHOURSLIVETVAVGFLOW,
indexvalue:WHOURSVODAVGFLOW") 
TBLPROPERTIES ("hbase.table.name" = "t_video_sdk_flow_h");

grant select,delete,insert on t_video_sdk_flow_h_hbase to user mapred;
