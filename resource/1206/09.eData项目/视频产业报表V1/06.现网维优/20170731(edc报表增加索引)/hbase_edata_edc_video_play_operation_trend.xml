<dataFetchers>
    <hBaseFetcherGroup user="video/hadoop" keyTab="conf/video.keytab">
    
        <!-- 近日 -->
        <fetcher>
            <resultType>singleMap</resultType>
            <name>edc_video_play_operation_trend_d</name>
            <from>t_video_edc_vod_analyse_d</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "providerid" paramName="PROVIDERID"/>
            <keyField name = "contentid" paramName="CONTENTID"/>
            <resultField>
             playtime,playusers,playtimes,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>
                <field name = "playusers" type = "int"/>
                <field name = "playtimes" type = "int"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        <!-- 当月 -->
		<fetcher>
            <resultType>singleMap</resultType>
            <name>edc_video_play_operation_trend_m</name>
            <from>t_video_edc_vod_analyse_dm</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "providerid" paramName="PROVIDERID"/>
            <keyField name = "contentid" paramName="CONTENTID"/>
            <resultField>
             playtime,playusers,playtimes,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>
                <field name = "playusers" type = "int"/>
                <field name = "playtimes" type = "int"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
		
        
        
        <!-- 日 -->
        <fetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_30d</name>
            <from>t_video_edc_vod_analyse_d</from>
            <scope expression = "dtime between {ENDTIME} - 30 and {ENDTIME} - 1" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "providerid" paramName="PROVIDERID"/>
            <keyField name = "contentid" paramName="CONTENTID"/>
            <resultField>
             playtime,playusers,playtimes,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>
                <field name = "playusers" type = "int"/>
                <field name = "playtimes" type = "int"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        
        <!-- 月 -->
        <fetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_12m</name>
            <from>t_video_edc_vod_analyse_m</from>
            <scope expression = "mtime between {ENDTIME} - 12 and {ENDTIME} - 1" unit= "month"/>
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "providerid" paramName="PROVIDERID"/>
            <keyField name = "contentid" paramName="CONTENTID"/>
            <resultField>
             playtime,playusers,playtimes,avgvodtime,mtime
            </resultField>
            <fieldDefinition>
                <field name = "mtime" type = "DATE" format = "yyyyMM"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>
                <field name = "playusers" type = "int"/>
                <field name = "playtimes" type = "int"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMM" />
            </fieldDefinition>
        </fetcher>
        
        
        <!-- 详细信息:近日 ALL ALL-->
        <pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_all_all_d</name>
            <from>t_video_edc_vod_analyse_d</from>
            <rowKey>projectid@[0-9a-zA-Z./-]*#providerid@[0-9a-zA-Z./-]*#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
        
        <!-- 详细信息:近日 NOT ALL-->
        <pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_not_all_d</name>
            <from>t_video_edc_vod_analyse_d</from>
            <rowKey>projectid@{projectid}#providerid@[0-9a-zA-Z./-]*#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>projectid@{projectid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <filterField name = "projectid" paramName="PROJECTID" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
		
		<!-- 详细信息:近日 ALL NOT-->
        <pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_all_not_d</name>
            <from>t_video_edc_vod_analyse_d</from>
            <rowKey>projectid@[0-9a-zA-Z./-]*#providerid@{providerid}#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>providerid@{providerid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <filterField name = "providerid" paramName="PROVIDERID" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
		
		
		<!-- 详细信息:近日 NOT NOT-->
        <pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_not_not_d</name>
            <from>t_video_edc_vod_analyse_d</from>
            <rowKey>projectid@{projectid}#providerid@{providerid}#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>projectid@{projectid}#providerid@{providerid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <filterField name = "projectid" paramName="PROJECTID" isKey="true"/>
			<filterField name = "providerid" paramName="PROVIDERID" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
		
		
		
		<!-- 详细信息:当月 ALL ALL-->
		<pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_all_all_m</name>
            <from>t_video_edc_vod_analyse_dm</from>
            <rowKey>projectid@[0-9a-zA-Z./-]*#providerid@[0-9a-zA-Z./-]*#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
		
		<!-- 详细信息:当月 NOT ALL-->
		<pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_not_all_m</name>
            <from>t_video_edc_vod_analyse_dm</from>
            <rowKey>projectid@{projectid}#providerid@[0-9a-zA-Z./-]*#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>projectid@{projectid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <filterField name = "projectid" paramName="PROJECTID" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
		
		<!-- 详细信息:当月 ALL NOT-->
		<pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_all_not_m</name>
            <from>t_video_edc_vod_analyse_dm</from>
            <rowKey>projectid@[0-9a-zA-Z./-]*#providerid@{providerid}#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>providerid@{providerid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <filterField name = "providerid" paramName="PROVIDERID" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
		
		<!-- 详细信息:当月 NOT NOT-->
		<pageFetcher>
            <resultType>arrayMap</resultType>
            <name>edc_play_operation_trend_detail_not_not_m</name>
            <from>t_video_edc_vod_analyse_dm</from>
            <rowKey>projectid@{projectid}#providerid@{providerid}#contentid@[0-9a-zA-Z./-]*#dtime@{dtime}#</rowKey>
			<indexKey>projectid@{projectid}#providerid@{providerid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
			<filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <filterField name = "projectid" paramName="PROJECTID" isKey="true"/>
			<filterField name = "providerid" paramName="PROVIDERID" isKey="true"/>
            <resultField>
            contentid,contentname,companyname,playtime,playtimeproportion,playrank,playusers,playusersproportion,playtimes,playtimesproportion,avgvodtime,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "contentid" type = "string"/>
                <field name = "contentname" type = "string"/>
                <field name = "companyname" type = "string"/>
                <field name = "playtime" type = "double" formula="PLAYTIME / 60.00" format= "0.00"/>                
                <field name = "playtimeproportion" type = "double" formula="PLAYTIMEPROPORTION * 100.00" format= "0.00"/>
                <field name = "playrank" type = "int"/>
                <field name = "playusers" type = "int"/>
                <field name = "playusersproportion" type = "double" formula="PLAYUSERSPROPORTION * 100.00" format= "0.00"/>
                <field name = "playtimes" type = "int"/>
                <field name = "playtimesproportion" type = "double" formula="PLAYTIMESPROPORTION * 100.00" format= "0.00"/>
                <field name = "avgvodtime" type = "double" formula="AVGVODTIME / 60.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
		
		
        
    </hBaseFetcherGroup>
</dataFetchers>