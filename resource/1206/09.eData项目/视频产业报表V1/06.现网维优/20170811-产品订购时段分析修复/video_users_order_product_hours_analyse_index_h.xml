<reportIndexGroup>
    <multiHqlReportIndexs>
        <!--  每天每时段 观看用户数 dayorderproduct -->
        <multiHqlReportIndex>
            <indexKey>video.order.product.analyse.hours.dayorderproduct.h</indexKey>
            <fieldName>dayorderproduct</fieldName>
            <hql>
                <![CDATA[
				select projectid,
					   activitychannelid,
					   concat(dtime,hourstime) htime ,
					   dayorderproduct
				from ( select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '00' hourstime,
							  if(h00orderproduct is null,0,h00orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '01' hourstime,
							  if(h01orderproduct is null,0,h01orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '02' hourstime,
							  if(h02orderproduct is null,0,h02orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '03' hourstime,
							  if(h03orderproduct is null,0,h03orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'	 
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '04' hourstime,
							  if(h04orderproduct is null,0,h04orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '05' hourstime,
							  if(h05orderproduct is null,0,h05orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '06' hourstime,
							  if(h06orderproduct is null,0,h06orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '07' hourstime,
							  if(h07orderproduct is null,0,h07orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '08' hourstime,
							  if(h08orderproduct is null,0,h08orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '09' hourstime,
							  if(h09orderproduct is null,0,h09orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'				
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '10' hourstime,
							  if(h10orderproduct is null,0,h10orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '11' hourstime,
							  if(h11orderproduct is null,0,h11orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '12' hourstime,
							  if(h12orderproduct is null,0,h12orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'							 
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '13' hourstime,
							  if(h13orderproduct is null,0,h13orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '14' hourstime,
							  if(h14orderproduct is null,0,h14orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '15' hourstime,
							  if(h15orderproduct is null,0,h15orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '16' hourstime,
							  if(h16orderproduct is null,0,h16orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '17' hourstime,
							  if(h17orderproduct is null,0,h17orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '18' hourstime,
							  if(h18orderproduct is null,0,h18orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '19' hourstime,
							  if(h19orderproduct is null,0,h19orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '20' hourstime,
							  if(h20orderproduct is null,0,h20orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '21' hourstime,
							  if(h21orderproduct is null,0,h21orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '22' hourstime,
							  if(h22orderproduct is null,0,h22orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					union all
					   select projectid,
							  if(activitychannelid is null,'ALL',activitychannelid) activitychannelid,
							  t.dtime dtime,
							  '23' hourstime,
							  if(h23orderproduct is null,0,h23orderproduct) dayorderproduct
						 from video.t_video_users_order_product_day_analyse_d_hbase t
						where t.dtime > '{STARTTIME}'
						  and t.dtime < '{ENDTIME}'
					)tt
				group by projectid,activitychannelid,concat(dtime,hourstime),dayorderproduct
                ]]>
            </hql>
        </multiHqlReportIndex>
    
    </multiHqlReportIndexs>
</reportIndexGroup>
