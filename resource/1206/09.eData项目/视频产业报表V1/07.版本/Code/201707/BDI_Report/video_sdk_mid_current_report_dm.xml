<reportSuite>
    <reports>
        <report tableName = "t_video_sdk_current_dm"
				keyFields = "projectid,activitychannelid,activityid,platformid,dtime" 
				period = "daily" timeFormat = "yyyyMMdd" timeField = "dtime">
            <fieldDefinition>
                <field name="projectid" regular="[0-9a-zA-Z./-]*"/>
				<field name="activitychannelid" regular="[0-9a-zA-Z./-]*"/>
				<field name="activityid" regular="[0-9a-zA-Z./-]*"/>
				<field name="platformid" regular="[0-9a-zA-Z./-]*"/>
                <field name="dtime"  regular="[0-9a-zA-Z./-]*"/>
            </fieldDefinition>
			<!--
			  上报事件中间结算月表
			-->
			<materialViewers>
				<materialViewer tableName = "video.t_mid_video_sdk_current_dm" clear="false" partition="id,date">
					<hql>
					<![CDATA[
		select projectid,platformid,activitychannelid,activityid,dtime,
		       sum(newvisitor) newvisitor,
			   sum(totalvisitor) totalvisitor,
			   sum(activeusers) activeusers,
			   sum(registeruseractive) registeruseractive,
			   sum(neworderuser) neworderuser,
			   sum(loginuser) loginuser,
			   projectid id, dtime date
		  from(
			     select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor, activeusers,0 registeruseractive,0 neworderuser,0 loginuser
				   from video.t_mid_video_sdk_activeusers_dm
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser, loginuser
				   from video.t_mid_video_sdk_loginuser_dm
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				 union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,neworderuser,0 loginuser
				   from video.t_mid_video_sdk_neworderuser_dm
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser,0 loginuser
				   from video.t_mid_video_sdk_newvisitor_dm
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers, registeruseractive,0 neworderuser,0 loginuser
				   from video.t_mid_video_sdk_reguseractive_dm
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser,0 loginuser
				   from video.t_mid_video_sdk_totalvisitor_dm
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				) a
				group by projectid,platformid,activitychannelid,activityid,dtime
					]]>
					</hql>
				</materialViewer>
			</materialViewers>
           <dimensions>
                <dimension id = "0" >
                    <reportIndex>
						video.sdk.current.column.dm
                    </reportIndex>
                </dimension>
            </dimensions> 
        </report>
    </reports>
</reportSuite>
