<dataFetchers>
    <hBaseFetcherGroup user="video/hadoop" keyTab="conf/video.keytab">
        <fetcher><!-- 近日 -->
            <resultType>singleMap</resultType>
            <name>user_active_d</name>
            <from>t_video_develop_user_active_d</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <keyField name = "platformid" paramName="PLATFORMID"/>
            <resultField>
             activeusers,dayactiveusers,registeruseractive,registeruseractiverate,watchusers,totalregisteruser,totalvisitor,dtime
            </resultField>		
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
				<field name = "activeusers" type = "int"/>               
                <field name = "dayactiveusers" type = "double" format= "0.00"/>
				<field name = "registeruseractive" type = "int"/>   
				<field name = "registeruseractiverate" type = "double" formula="REGISTERUSERACTIVERATE * 100.00" format= "0.00"/>
				<field name = "watchusers" type = "int"/>               
                <field name = "totalregisteruser" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        
        <fetcher><!-- 当周 -->
            <resultType>singleMap</resultType>
            <name>user_active_sd</name>
            <from>t_video_develop_user_active_sd</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <keyField name = "platformid" paramName="PLATFORMID"/>
            <resultField>
             activeusers,dayactiveusers,registeruseractive,registeruseractiverate,watchusers,totalregisteruser,totalvisitor,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "activeusers" type = "int"/>               
                <field name = "dayactiveusers" type = "double" format= "0.00"/>
				<field name = "registeruseractive" type = "int"/>   
				<field name = "registeruseractiverate" type = "double" formula="REGISTERUSERACTIVERATE * 100.00" format= "0.00"/>
				<field name = "watchusers" type = "int"/>               
                <field name = "totalregisteruser" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        
        <fetcher><!-- 当月 -->
            <resultType>singleMap</resultType>
            <name>user_active_td</name>
            <from>t_video_develop_user_active_td</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <keyField name = "platformid" paramName="PLATFORMID"/>
            <resultField>
             activeusers,dayactiveusers,registeruseractive,registeruseractiverate,watchusers,totalregisteruser,totalvisitor,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "activeusers" type = "int"/>               
                <field name = "dayactiveusers" type = "double" format= "0.00"/>
				<field name = "registeruseractive" type = "int"/>   
				<field name = "registeruseractiverate" type = "double" formula="REGISTERUSERACTIVERATE * 100.00" format= "0.00"/>
				<field name = "watchusers" type = "int"/>               
                <field name = "totalregisteruser" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        
        
        <fetcher><!-- 日 -->
            <resultType>arrayMap</resultType>
            <name>user_active_30d</name>
            <from>t_video_develop_user_active_d</from>
            <scope expression = "dtime between {ENDTIME} - 30 and {ENDTIME} - 1" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <keyField name = "platformid" paramName="PLATFORMID"/>
            <resultField>
             activeusers,dayactiveusers,registeruseractive,registeruseractiverate,watchusers,totalregisteruser,totalvisitor,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "activeusers" type = "int"/>               
                <field name = "dayactiveusers" type = "double" format= "0.00"/>
				<field name = "registeruseractive" type = "int"/>   
				<field name = "registeruseractiverate" type = "double" formula="REGISTERUSERACTIVERATE * 100.00" format= "0.00"/>
				<field name = "watchusers" type = "int"/>               
                <field name = "totalregisteruser" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        <fetcher><!-- 周-->
            <resultType>arrayMap</resultType>
            <name>user_active_14w</name>
            <from>t_video_develop_user_active_w</from>
            <scope expression = "wtime between {ENDTIME} - 14 and {ENDTIME} - 1" unit= "week"/>
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <keyField name = "platformid" paramName="PLATFORMID"/>
            <resultField>
             activeusers,dayactiveusers,registeruseractive,registeruseractiverate,watchusers,totalregisteruser,totalvisitor,wtime
            </resultField>
            <fieldDefinition>
                <field name = "wtime" type = "DATE" format = "yyyyww"/>
                <field name = "activeusers" type = "int"/>               
                <field name = "dayactiveusers" type = "double" format= "0.00"/>
				<field name = "registeruseractive" type = "int"/>   
				<field name = "registeruseractiverate" type = "double" formula="REGISTERUSERACTIVERATE * 100.00" format= "0.00"/>
				<field name = "watchusers" type = "int"/>               
                <field name = "totalregisteruser" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyww" />
            </fieldDefinition>
        </fetcher>
        
        <fetcher><!-- 月 -->
            <resultType>arrayMap</resultType>
            <name>user_active_12m</name>
            <from>t_video_develop_user_active_m</from>
            <scope expression = "mtime between {ENDTIME} - 12 and {ENDTIME} - 1" unit= "month"/>
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <keyField name = "platformid" paramName="PLATFORMID"/>
            <resultField>
             activeusers,dayactiveusers,registeruseractive,registeruseractiverate,watchusers,totalregisteruser,totalvisitor,mtime
            </resultField>
            <fieldDefinition>
                <field name = "mtime" type = "DATE" format = "yyyyMM"/>
                <field name = "activeusers" type = "int"/>               
                <field name = "dayactiveusers" type = "double" format= "0.00"/>
				<field name = "registeruseractive" type = "int"/>   
				<field name = "registeruseractiverate" type = "double" formula="REGISTERUSERACTIVERATE * 100.00" format= "0.00"/>
				<field name = "watchusers" type = "int"/>               
                <field name = "totalregisteruser" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMM" />
            </fieldDefinition>
        </fetcher>
        
        
        
    </hBaseFetcherGroup>
</dataFetchers>