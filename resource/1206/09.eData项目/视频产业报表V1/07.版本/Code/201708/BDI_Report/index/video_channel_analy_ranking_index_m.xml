<reportIndexGroup>
    <multiHqlReportIndexs>		
		<!--  新增注册用户{排序} newregisteruser  -->
		<!--  渠道累计注册用户数 allregisteruser  -->
		<!--  注册用户活跃数{排序} registeruseractive  -->
		<!--  当期付费用户数{排序} newpayuser  -->
		<!--  美元 当期 付费流水 newincome-->
		<!--  本币 当期 付费流水 localnewincome-->
		<!--  美元 当年累计收入{排序} yearallincome-->
		<!--  本币 当年累计收入{排序} localyearallincome-->
		<!--  channelname渠道名称：en_value,zh_value -->
		<!--  201707 修改注册用户活跃数从中间表取t_mid_video_sdk_current_dm,取终端为ALL的数据-->
        <multiHqlReportIndex>
            <indexKey>video.channel.ranking.columns.m</indexKey>
            <fieldName>newregisteruser,allregisteruser,newpayuser,newincome,localnewincome,yearallincome,localyearallincome,en_value,zh_value</fieldName>
            <hql>
                <![CDATA[
				select projectid,activitychannelid,mtime,
					   newregisteruser,
					   allregisteruser,
					   newpayuser,
					   newincome,localnewincome,
					   yearallincome,localyearallincome,
					   en_value,zh_value
				  from (select projectid,
							   if(t.activitychannelid is null, 'ALL', t.activitychannelid) activitychannelid,
							   substr(t.dtime,0,6) mtime,
							   if(t.newregisteruser is null, 0, t.newregisteruser) newregisteruser,
							   if(t.allregisteruser is null, 0, t.allregisteruser) allregisteruser,
							   if(t.newpayuser is null, 0, t.newpayuser) newpayuser,
							   if(t.newincome is null, 0, t.newincome) newincome,
							   if(t.localnewincome is null, 0, t.localnewincome) localnewincome,
							   if(t.yearallincome is null, 0, t.yearallincome) yearallincome,
							   if(t.localyearallincome is null, 0, t.localyearallincome) localyearallincome,
							   en_value,
							   zh_value
						  from video.t_video_channel_analy_ranking_td_hbase t
						 where substr(t.dtime,0,6) > '{STARTTIME}'
						   and substr(t.dtime,0,6) < '{ENDTIME}'
						   and substr(t.dtime,0,6) < from_unixtime(unix_timestamp(date_add(from_unixtime(unix_timestamp(t.dtime,
													 'yyyyMMdd'),'yyyy-MM-dd'),1),'yyyy-MM-dd'),'yyyyMM')) tt
				 group by projectid,activitychannelid,mtime,
						  newregisteruser,
						  allregisteruser,
						  newpayuser,
						  newincome,localnewincome,
						  yearallincome,localyearallincome,
						  en_value,zh_value
                ]]>
            </hql>
        </multiHqlReportIndex>
		<!--  201707 修改注册用户活跃数从中间表取t_mid_video_sdk_current_dm,取终端为ALL的数据-->
		<multiHqlReportIndex>
            <indexKey>video.channel.ranking.registeractive.m</indexKey>
            <fieldName>registeruseractive</fieldName>
            <hql>
                <![CDATA[
				select projectid,activitychannelid,mtime,
					   sum(registeruseractive) registeruseractive
				  from (select projectid,
							   activitychannelid,
							   substr(t.dtime,0,6) mtime,
							   registeruseractive
						  from video.t_mid_video_sdk_current_dm t
						 where substr(t.date,0,6) > '{STARTTIME}'
						   and substr(t.date,0,6) < '{ENDTIME}'
						   and substr(t.date,0,6) < from_unixtime(unix_timestamp(date_add(from_unixtime(unix_timestamp(t.date,
													 'yyyyMMdd'),'yyyy-MM-dd'),1),'yyyy-MM-dd'),'yyyyMM')) tt
						   and t.platformid = 'ALL'
						   and t.activityid = 'ALL'
				 group by projectid,activitychannelid,mtime
                ]]>
            </hql>
        </multiHqlReportIndex>
    </multiHqlReportIndexs>
</reportIndexGroup>
