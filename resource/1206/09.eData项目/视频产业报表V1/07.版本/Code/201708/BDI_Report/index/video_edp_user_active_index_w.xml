<reportIndexGroup>
<multiHqlReportIndexs>
	<!--
	[201703]
	活跃用户数 activeusers
	日活用户数 dayactiveusers
	注册用户活跃数 registeruseractive
	注册用户活跃率 registeruseractiverate
	观看用户数 watchusers
	注册用户总数 totalregisteruser
	游客用户总数 totalvisitor
	[201707]
	修改活跃用户数 、注册用户活跃数、游客用户总数 从中间表获取t_mid_video_sdk_current_dw
	-->
	<multiHqlReportIndex>
		<indexKey>video.edp.user.active.platcolumns.w</indexKey>
		<fieldName>dayactiveusers,registeruseractiverate</fieldName>
		<hql>
			<![CDATA[
			select projectid,activitychannelid,platformid,wtime,
				   dayactiveusers,
				   registeruseractiverate				   
			  from (select t1.projectid,
						   if(t1.activitychannelid is null,'ALL',t1.activitychannelid) activitychannelid,
						   if(t1.platformid is null, 'ALL', t1.platformid) platformid,
						   t2.wtime,
						   if(t1.dayactiveusers is null, 0, t1.dayactiveusers) dayactiveusers,
						   if(t1.registeruseractiverate is null, 0, t1.registeruseractiverate) registeruseractiverate,
						   if(t1.watchusers is null, 0, t1.watchusers) watchusers,
						   if(t1.totalregisteruser is null, 0, t1.totalregisteruser) totalregisteruser
					  from video.t_video_develop_user_active_sd_hbase t1,
						   (select t.wtime,t.dtime
							  from video.t_bdi_muchtv_video_rundate t
							 where t.wtime > '{STARTTIME}'
							   and t.wtime < '{ENDTIME}'
							   and t.weekdays =7 ) t2
					  where t1.dtime = t2.dtime
				) tt
			 group by projectid,activitychannelid,platformid,wtime,
					  dayactiveusers,
					  registeruseractiverate
			]]>
		</hql>
	</multiHqlReportIndex>
	<!--watchusers,totalregisteruser 不区分终端-->
	<multiHqlReportIndex>
		<indexKey>video.edp.user.active.columns.w</indexKey>
		<fieldName>watchusers,totalregisteruser</fieldName>
		<hql>
			<![CDATA[
			select projectid,activitychannelid,platformid,wtime,
				   watchusers,
				   totalregisteruser
			  from (select t1.projectid,
						   if(t1.activitychannelid is null,'ALL',t1.activitychannelid) activitychannelid,
						   if(t1.platformid is null, 'ALL', t1.platformid) platformid,
						   t2.wtime,
						   if(t1.dayactiveusers is null, 0, t1.dayactiveusers) dayactiveusers,
						   if(t1.registeruseractiverate is null, 0, t1.registeruseractiverate) registeruseractiverate,
						   if(t1.watchusers is null, 0, t1.watchusers) watchusers,
						   if(t1.totalregisteruser is null, 0, t1.totalregisteruser) totalregisteruser
					  from video.t_video_develop_user_active_sd_hbase t1,
						   (select t.wtime,t.dtime
							  from video.t_bdi_muchtv_video_rundate t
							 where t.wtime > '{STARTTIME}'
							   and t.wtime < '{ENDTIME}'
							   and t.weekdays =7 ) t2
					  where t1.dtime = t2.dtime
					    and t1.platformid is null
				) tt
			 group by projectid,activitychannelid,platformid,wtime,
					  watchusers,
					  totalregisteruser
			]]>
		</hql>
	</multiHqlReportIndex>
	<!-- 
    [201707]
	修改活跃用户数 、注册用户活跃数、游客用户总数 从t_video_develop_user_active_sd_hbase换成从中间表获取t_mid_video_sdk_current_dw
	201708需求，从t_mid_video_sdk_current_d获取appdownload
	 -->
	<multiHqlReportIndex>
		<indexKey>video.edp.user.active.activers.w</indexKey>
		<fieldName>activeusers,registeruseractive,totalvisitor,appdownload</fieldName>
		<hql>
			<![CDATA[
			select projectid,activitychannelid,platformid,wtime,
				   sum(activeusers) activeusers,
				   sum(registeruseractive) registeruseractive,
				   sum(totalvisitor) totalvisitor,
				   sum(appdownload) appdownload
			  from (select t1.projectid,
						   activitychannelid,
						   platformid,
						   t2.wtime,
						   activeusers,
						   registeruseractive,
						   totalvisitor,
						   appdownload
					  from video.t_mid_video_sdk_current_dw t1,
						   (select t.wtime,t.dtime
							  from video.t_bdi_muchtv_video_rundate t
							 where t.wtime > '{STARTTIME}'
							   and t.wtime < '{ENDTIME}'
							   and t.weekdays =7 ) t2
					  where t1.date = t2.dtime
					    and t1.activityid = 'ALL'
				) tt
			 group by projectid,activitychannelid,platformid,wtime					 
			]]>
		</hql>
	</multiHqlReportIndex>
</multiHqlReportIndexs>
</reportIndexGroup>
