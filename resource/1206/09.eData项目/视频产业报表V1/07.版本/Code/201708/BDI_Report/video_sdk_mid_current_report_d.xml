<reportSuite>
    <reports>
        <report tableName = "t_video_sdk_current_d"
				keyFields = "projectid,activitychannelid,activityid,platformid,dtime" 
				period = "daily" timeFormat = "yyyyMMdd" timeField = "dtime">
            <fieldDefinition>
                <field name="projectid" regular="[0-9a-zA-Z./-]*"/>
				<field name="activitychannelid" regular="[0-9a-zA-Z./-]*"/>
				<field name="activityid" regular="[0-9a-zA-Z./-]*"/>
				<field name="platformid" regular="[0-9a-zA-Z./-]*"/>
                <field name="dtime"  regular="[0-9a-zA-Z./-]*"/>
            </fieldDefinition>
			<!--
			  上报事件中间结算天表
			-->
			<materialViewers>
				<materialViewer tableName = "video.t_mid_video_sdk_current_d" clear="false" partition="date">
					<hql>
					<![CDATA[
		select projectid,platformid,activitychannelid,activityid,dtime,
		       sum(if(newvisitor is null,0,newvisitor))                          newvisitor,
			   sum(if(totalvisitor is null,0,totalvisitor))                      totalvisitor,
			   sum(if(activeusers is null,0,activeusers))                        activeusers,
			   sum(if(registeruseractive is null,0,registeruseractive))          registeruseractive,
			   sum(if(neworderuser is null,0,neworderuser))                      neworderuser,
			   sum(if(loginuser is null,0,loginuser))                            loginuser,
			   sum(if(appdownload is null,0,appdownload))                        appdownload,
			   sum(if(newsubscriber is null,0,newsubscriber))                    newsubscriber,
			   sum(if(day01retentionrate is null,0,day01retentionrate))          day01retentionrate,
			   sum(if(day03retentionrate is null,0,day03retentionrate))          day03retentionrate,
			   sum(if(day07retentionrate is null,0,day07retentionrate))          day07retentionrate,
			   sum(if(day15retentionrate is null,0,day15retentionrate))          day15retentionrate,
			   sum(if(day30retentionrate is null,0,day30retentionrate))          day30retentionrate,
			   dtime date
		  from(
			     select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor, activeusers,0 registeruseractive,0 neworderuser,0 loginuser,0 appdownload,
						0 newsubscriber,0 day01retentionrate,0 day03retentionrate,0 day07retentionrate,0 day15retentionrate,0 day30retentionrate
				   from video.t_mid_video_sdk_activeusers_d
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser, loginuser,0 appdownload,
						0 newsubscriber,0 day01retentionrate,0 day03retentionrate,0 day07retentionrate,0 day15retentionrate,0 day30retentionrate
				   from video.t_mid_video_sdk_loginuser_d
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				 union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,neworderuser,0 loginuser,0 appdownload,
						0 newsubscriber,0 day01retentionrate,0 day03retentionrate,0 day07retentionrate,0 day15retentionrate,0 day30retentionrate
				   from video.t_mid_video_sdk_neworderuser_d
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser,0 loginuser,0 appdownload,
						0 newsubscriber,0 day01retentionrate,0 day03retentionrate,0 day07retentionrate,0 day15retentionrate,0 day30retentionrate
				   from video.t_mid_video_sdk_newvisitor_d
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers, registeruseractive,0 neworderuser,0 loginuser,0 appdownload,
						0 newsubscriber,0 day01retentionrate,0 day03retentionrate,0 day07retentionrate,0 day15retentionrate,0 day30retentionrate
				   from video.t_mid_video_sdk_reguseractive_d
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser,0 loginuser,0 appdownload,
						0 newsubscriber,0 day01retentionrate,0 day03retentionrate,0 day07retentionrate,0 day15retentionrate,0 day30retentionrate
				   from video.t_mid_video_sdk_totalvisitor_d
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser,0 loginuser,appdownload,
						0 newsubscriber,0 day01retentionrate,0 day03retentionrate,0 day07retentionrate,0 day15retentionrate,0 day30retentionrate
				   from video.t_mid_video_sdk_appdownload_d
				  where date > '{STARTTIME}' and  date < '{ENDTIME}'
				  union all
				 select projectid,platformid,activitychannelid,activityid,dtime,
				        0 newvisitor,0 totalvisitor,0 activeusers,0 registeruseractive,0 neworderuser,0 loginuser,0 appdownload,
                        newsubscriber,day01retentionrate,day03retentionrate,day07retentionrate,day15retentionrate,day30retentionrate						
				   from video.t_mid_video_sdk_retentionrate_d
				  where date > from_unixtime(unix_timestamp(date_sub(from_unixtime(unix_timestamp('{STARTTIME}',
												'yyyyMMdd'),'yyyy-MM-dd'),30),'yyyy-MM-dd'), 'yyyyMMdd')
					and  date < '{ENDTIME}'
				) a
				group by projectid,platformid,activitychannelid,activityid,dtime
					]]>
					</hql>
				</materialViewer>
			</materialViewers>
            <dimensions>
                <dimension id = "0" >
                    <reportIndex>
						video.sdk.current.column.d
                    </reportIndex>
                </dimension>
            </dimensions>
        </report>
    </reports>
</reportSuite>
