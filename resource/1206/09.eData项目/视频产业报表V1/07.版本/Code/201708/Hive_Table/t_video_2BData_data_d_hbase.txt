DROP TABLE video.t_video_2BData_data_d_hbase;
CREATE EXTERNAL TABLE video.t_video_2BData_data_d_hbase
(
key                     string,
projectid               string,
dtime                   string,
newvisitor              int,
activeusers             int,
totalvisitor            int,
registeruseractive      int,
activeusers_m           int,
registeruseractive_m    int,
newregisteruser         int,
totalregisteruser       int,
totalactiveaccount      int,
newpay                  int,
pay                     int,
pay_m                   int,
paytotal                int,
newincome               double,
arpuincome              double,
videosnumber            int,
playtimes               int,
playusers               int,
playtime                int,
percapitaplaytime       double,
percapitaplay           double,
avgvideotime            double,
devicearpu              double,
accountarpu             double
)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:DTIME,
indexvalue:NEWVISITOR,
indexvalue:ACTIVEUSERS,
indexvalue:TOTALVISITOR,
indexvalue:REGISTERUSERACTIVE,
indexvalue:ACTIVEUSERS_M,
indexvalue:REGISTERUSERACTIVE_M,
indexvalue:NEWREGISTERUSER,
indexvalue:TOTALREGISTERUSER,
indexvalue:TOTALACTIVEACCOUNT,
indexvalue:NEWPAY,
indexvalue:PAY,
indexvalue:PAY_M,
indexvalue:PAYTOTAL,
indexvalue:NEWINCOME,
indexvalue:ARPUINCOME,
indexvalue:VIDEOSNUMBER,
indexvalue:PLAYTIMES,
indexvalue:PLAYUSERS,
indexvalue:PLAYTIME,
indexvalue:PERCAPITAPLAYTIME,
indexvalue:PERCAPITAPLAY,
indexvalue:AVGVIDEOTIME,
indexvalue:DEVICEARPU,
indexvalue:ACCOUNTARPU
") 
TBLPROPERTIES ("hbase.table.name" = "t_video_2BData_data_d");
grant select,delete,insert on video.t_video_2BData_data_d_hbase to user mapred;