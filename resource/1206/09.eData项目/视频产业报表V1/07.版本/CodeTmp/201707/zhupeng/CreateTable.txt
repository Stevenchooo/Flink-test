create table video.t_mid_day_newlogin_visitor
(
projectid string,
dtime string,
userid string,
time  string,
platformid string
)
partitioned by(
id string,
date string
)
row format delimited fields terminated by '\t' map keys terminated by '&' stored as textfile;
grant select,delete,insert on video.t_mid_day_newlogin_visitor to user mapred;

drop table video.t_mid_video_sdk_current_d;
create table video.t_mid_video_sdk_current_d
(
projectid string,
platformid string,
activitychannelid string,
activityid  string,
dtime string,
newvisitor int,
totalvisitor int,
activeusers  int,
registeruseractive int,
neworderuser int,
loginuser int
)
partitioned by(
id string,
date string
)
row format delimited fields terminated by '\t' map keys terminated by '&' stored as textfile;
grant select,delete,insert on t_mid_video_sdk_current_d to user mapred;

drop table video.t_mid_video_sdk_current_dw;
create table video.t_mid_video_sdk_current_dw
(
projectid string,
platformid string,
activitychannelid string,
activityid  string,
dtime string,
newvisitor int,
totalvisitor int,
activeusers  int,
registeruseractive int,
neworderuser int,
loginuser int
)
partitioned by(
id string,
date string
)
row format delimited fields terminated by '\t' map keys terminated by '&' stored as textfile;
grant select,delete,insert on t_mid_video_sdk_current_dw to user mapred;

drop table video.t_mid_video_sdk_current_dm;
create table video.t_mid_video_sdk_current_dm
(
projectid string,
platformid string,
activitychannelid string,
activityid  string,
dtime string,
newvisitor int,
totalvisitor int,
activeusers  int,
registeruseractive int,
neworderuser int,
loginuser int
)
partitioned by(
id string,
date string
)
row format delimited fields terminated by '\t' map keys terminated by '&' stored as textfile;
grant select,delete,insert on t_mid_video_sdk_current_dm to user mapred;


./start.sh -t /home/bdi/report_home/config/report/video_sdk_mid_current_report_d.xml -s 20170711000000 -e 20170712000000 -u video/hadoop -k video.keytab -q QueueC


CREATE TABLE IF NOT EXISTS T_JS_EVENT
(
AccessTime string,
ClientIP string,
UserAgent string,
UserAccount string,
AppKey string,
EventName string,
EventLabel string,
VisitKey string,
c1 string,
c2 string,
c3 string,
c4 string,
c5 string,
c6 string,
c7 string,
c8 string,
c9 string,
c10 string
)
partitioned by (
date STRING
)
ROW FORMAT delimited fields terminated by '\t' MAP KEYS TERMINATED BY '&' STORED AS TEXTFILE;
grant select,delete,insert on T_JS_EVENT to user hiveadmin;
grant select,delete,insert on T_JS_EVENT to user bdildap;
grant select,delete,insert on T_JS_EVENT to user mapred;

CREATE TABLE IF NOT EXISTS T_SDK_EVENT
(
time string,
ip string,
platformid int,
userid string,
sessionid string,
sdkversion string,
appkey string,
appversioncode string,
eventname string,
eventlabel string,
accesstime string,
deviceid string,
networktype string,
extappkey string,
c1 string,
c2 string,
c3 string,
c4 string,
c5 string,
d1 string,
d2 string,
d3 string,
d4 string,
d5 string,
c6 string,
c7 string,
c8 string,
c9 string,
c10 string,
accesstimeex string
)
partitioned by (
date STRING
)
ROW FORMAT delimited fields terminated by '\t' MAP KEYS TERMINATED BY '&' STORED AS TEXTFILE;
grant select,delete,insert on T_SDK_EVENT to user hiveadmin;
grant select,delete,insert on T_SDK_EVENT to user bdildap;
grant select,delete,insert on T_SDK_EVENT to user mapred;