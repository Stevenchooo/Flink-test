<dataFetchers>
    <hBaseFetcherGroup user="video/hadoop" keyTab="conf/video.keytab">
        <fetcher><!-- 近日 -->
            <resultType>singleMap</resultType>
            <name>user_access_d</name>
            <from>t_video_develop_user_grab_d</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
			<keyField name = "platformid" paramName="PLATFORMID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <resultField>
             newvisitor,totalvisitor,newregisteruser,neworderuser,loginuser,allregisteruser,totalregisteruser,newunsubscribeproduct,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "newvisitor" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "newregisteruser" type = "int"/>
                <field name = "neworderuser" type = "int"/>
                <field name = "loginuser" type = "int"/>    
                <field name = "allregisteruser" type = "int"/>
                <field name = "totalregisteruser" type = "int"/>
                <field name = "newunsubscribeproduct" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        
        <fetcher><!-- 当周 -->
            <resultType>singleMap</resultType>
            <name>user_access_sd</name>
            <from>t_video_develop_user_grab_sd</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
			<keyField name = "platformid" paramName="PLATFORMID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <resultField>
             newvisitor,totalvisitor,newregisteruser,neworderuser,loginuser,allregisteruser,totalregisteruser,newunsubscribeproduct,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "newvisitor" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "newregisteruser" type = "int"/>
                <field name = "neworderuser" type = "int"/>
                <field name = "loginuser" type = "int"/>    
                <field name = "allregisteruser" type = "int"/>
                <field name = "totalregisteruser" type = "int"/>
                <field name = "newunsubscribeproduct" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        
        <fetcher><!-- 当月 -->
            <resultType>singleMap</resultType>
            <name>user_access_td</name>
            <from>t_video_develop_user_grab_td</from>
            <scope expression = "dtime = {ENDTIME}" />
            <keyField name = "projectid" paramName="PROJECTID"/>
			<keyField name = "platformid" paramName="PLATFORMID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <resultField>
             newvisitor,totalvisitor,newregisteruser,neworderuser,loginuser,allregisteruser,totalregisteruser,newunsubscribeproduct,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "newvisitor" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "newregisteruser" type = "int"/>
                <field name = "neworderuser" type = "int"/>
                <field name = "loginuser" type = "int"/>    
                <field name = "allregisteruser" type = "int"/>
                <field name = "totalregisteruser" type = "int"/>
                <field name = "newunsubscribeproduct" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        
        
        <fetcher>
            <resultType>arrayMap</resultType>
            <name>user_access_30d</name>
            <from>t_video_develop_user_grab_d</from>
            <scope expression = "dtime between {ENDTIME} - 30 and {ENDTIME} - 1" />
            <keyField name = "projectid" paramName="PROJECTID"/>
			<keyField name = "platformid" paramName="PLATFORMID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <resultField>
             newvisitor,totalvisitor,newregisteruser,neworderuser,loginuser,allregisteruser,totalregisteruser,newunsubscribeproduct,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "newvisitor" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "newregisteruser" type = "int"/>
                <field name = "neworderuser" type = "int"/>
                <field name = "loginuser" type = "int"/>    
                <field name = "allregisteruser" type = "int"/>
                <field name = "totalregisteruser" type = "int"/>
                <field name = "newunsubscribeproduct" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>
        
        <fetcher><!-- 按周-->
            <resultType>arrayMap</resultType>
            <name>user_access_14w</name>
            <from>t_video_develop_user_grab_w</from>
            <scope expression = "wtime between {ENDTIME} - 14 and {ENDTIME} - 1" unit= "week"/>
            <keyField name = "projectid" paramName="PROJECTID"/>
			<keyField name = "platformid" paramName="PLATFORMID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <resultField>
             newvisitor,totalvisitor,newregisteruser,neworderuser,loginuser,allregisteruser,totalregisteruser,newunsubscribeproduct,wtime
            </resultField>
            <fieldDefinition>
                <field name = "wtime" type = "DATE" format = "yyyyww"/>
                <field name = "newvisitor" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "newregisteruser" type = "int"/>
                <field name = "neworderuser" type = "int"/>
                <field name = "loginuser" type = "int"/>    
                <field name = "allregisteruser" type = "int"/>
                <field name = "totalregisteruser" type = "int"/>
                <field name = "newunsubscribeproduct" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyww" />
            </fieldDefinition>
        </fetcher>
        
        <fetcher><!-- 按月 -->
            <resultType>arrayMap</resultType>
            <name>user_access_12m</name>
            <from>t_video_develop_user_grab_m</from>
            <scope expression = "mtime between {ENDTIME} - 12 and {ENDTIME} - 1" unit= "month"/>
            <keyField name = "projectid" paramName="PROJECTID"/>
			<keyField name = "platformid" paramName="PLATFORMID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
            <resultField>
             newvisitor,totalvisitor,newregisteruser,neworderuser,loginuser,allregisteruser,totalregisteruser,newunsubscribeproduct,mtime
            </resultField>
            <fieldDefinition>
                <field name = "mtime" type = "DATE" format = "yyyyMM"/>
                <field name = "newvisitor" type = "int"/>
				<field name = "totalvisitor" type = "int"/>
                <field name = "newregisteruser" type = "int"/>
                <field name = "neworderuser" type = "int"/>
                <field name = "loginuser" type = "int"/>    
                <field name = "allregisteruser" type = "int"/>
                <field name = "totalregisteruser" type = "int"/>
                <field name = "newunsubscribeproduct" type = "int"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMM" />
            </fieldDefinition>
        </fetcher>
        
        
        
    </hBaseFetcherGroup>
</dataFetchers>