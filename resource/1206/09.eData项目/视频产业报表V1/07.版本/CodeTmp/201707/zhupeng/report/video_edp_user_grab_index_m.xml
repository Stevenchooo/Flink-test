<reportIndexGroup>
    <multiHqlReportIndexs>
		<!--  当期 新增游客数(newvisitor)-->
		<!--	   游客用户总数(totalvisitor) 截止当日的累计的游客总数，根据设备ID去重；同一个用户更换设备，按照新的游客用户统计。-->
		<!--  当期 新增注册用户数 newregisteruser: 当期新增有注册行为的用户数量-->
		<!--  当期 新增订购用户 neworderuser: 当期新增订购产品(包括套餐和按次)的用户数量-->
		<!--  当期 登录用户数 loginuser: 当期使用客户端登录的用户数量-->
		<!--       累计注册用户总数 allregisteruser: 当前有过注册行为的用户总数，用户注销后也计算一个注册用户数。-->
		<!--       注册用户总数 totalregisteruser ：当前在注册状态的用户总数，用户注销后不计算注册用户总数。-->
		<!--  当期 新增退订用户 newunsubscribeproduct : 当期有退订产品行为的用户数量-->
        <multiHqlReportIndex>
            <indexKey>video.edp.user.grab.columns.m</indexKey>
            <fieldName>newvisitor,totalvisitor,newregisteruser,neworderuser,loginuser,allregisteruser,totalregisteruser,newunsubscribeproduct</fieldName>
            <hql>
                <![CDATA[
				select projectid,activitychannelid,platformid,mtime,
					   newvisitor,
					   totalvisitor,
					   newregisteruser,
					   neworderuser,
					   loginuser,
					   allregisteruser,
					   totalregisteruser,
					   newunsubscribeproduct
				  from (select projectid,
							   if(t.activitychannelid is null,'ALL',t.activitychannelid) activitychannelid,
							   if(t.platformid is null,'ALL',t.platformid) platformid,
							   substr(t.dtime, 0, 6) mtime,
							   if(newvisitor is null, 0, newvisitor) newvisitor,
							   if(totalvisitor is null, 0, totalvisitor) totalvisitor,
							   if(newregisteruser is null, 0, newregisteruser) newregisteruser,
							   if(neworderuser is null, 0, neworderuser) neworderuser,
							   if(loginuser is null, 0, loginuser) loginuser,
							   if(allregisteruser is null, 0, allregisteruser) allregisteruser,
							   if(totalregisteruser is null, 0, totalregisteruser) totalregisteruser,
							   if(newunsubscribeproduct is null, 0, newunsubscribeproduct) newunsubscribeproduct
						  from video.t_video_develop_user_grab_td_hbase t
						 where substr(t.dtime, 0, 6) > '{STARTTIME}'
						   and substr(t.dtime, 0, 6) < '{ENDTIME}'
						   and substr(t.dtime, 0, 6) <
							   from_unixtime(unix_timestamp(date_add(from_unixtime(unix_timestamp(t.dtime,
								'yyyyMMdd'),'yyyy-MM-dd'),1),'yyyy-MM-dd'),'yyyyMM')
					) tt
				 group by projectid,activitychannelid,platformid,mtime,
						  newvisitor,
						  totalvisitor,
						  newregisteruser,
						  neworderuser,
						  loginuser,
						  allregisteruser,
						  totalregisteruser,
						  newunsubscribeproduct	  
                ]]>
            </hql>
        </multiHqlReportIndex>

    </multiHqlReportIndexs>
</reportIndexGroup>
