/*********************************************************************************
假设20170130升级
第一步《上传升级前报文》
./start.sh -t /home/bdi/report_home/config/report/video_edp_user_active_report_d.xml -s 20161230000000 -e 20170102000000 -u video/hadoop -k video.keytab

第二步《上传定时报文》
./start.sh -t /home/bdi/report_home/config/report/video_edp_user_active_report_d.xml -s 20170101000000 -e 20170130000000 -u video/hadoop -k video.keytab
*********************************************************************************/

DROP TABLE video.t_video_develop_user_active_d_hbase;
CREATE EXTERNAL TABLE video.t_video_develop_user_active_d_hbase
(
key string,
projectid string,
activitychannelid string,
platformid string,
dtime string,
activeusers int,
dayactiveusers int,
registeruseractive int,
registeruseractiverate double,
watchusers int,
totalregisteruser int,
totalvisitor int,
allregisteruser int,
newregisteruser int,
newcanceluser int,
allproductorder int
)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:PLATFORMID,
indexvalue:DTIME,
indexvalue:ACTIVEUSERS,
indexvalue:DAYACTIVEUSERS,
indexvalue:REGISTERUSERACTIVE,
indexvalue:REGISTERUSERACTIVERATE,
indexvalue:WATCHUSERS,
indexvalue:TOTALREGISTERUSER,
indexvalue:TOTALVISITOR,
indexvalue:ALLREGISTERUSER,
indexvalue:NEWREGISTERUSER,
indexvalue:NEWCANCELUSER,
indexvalue:ALLPRODUCTORDER
") 
TBLPROPERTIES ("hbase.table.name" = "t_video_develop_user_active_d");
grant select,delete,insert on t_video_develop_user_active_d_hbase to user mapred;
