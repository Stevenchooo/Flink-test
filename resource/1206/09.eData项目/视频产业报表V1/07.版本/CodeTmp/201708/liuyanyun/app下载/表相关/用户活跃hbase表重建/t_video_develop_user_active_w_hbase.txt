DROP TABLE video.t_video_develop_user_active_w_hbase;
CREATE EXTERNAL TABLE video.t_video_develop_user_active_w_hbase
(
key string,
projectid string,
activitychannelid string,
platformid string,
wtime string,
activeusers int,
dayactiveusers int,
registeruseractive int,
registeruseractiverate double,
watchusers int,
totalregisteruser int,
totalvisitor int,
appdownload int
)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,
indexvalue:PROJECTID,
indexvalue:ACTIVITYCHANNELID,
indexvalue:PLATFORMID,
indexvalue:WTIME,
indexvalue:ACTIVEUSERS,
indexvalue:DAYACTIVEUSERS,
indexvalue:REGISTERUSERACTIVE,
indexvalue:REGISTERUSERACTIVERATE,
indexvalue:WATCHUSERS,
indexvalue:TOTALREGISTERUSER,
indexvalue:TOTALVISITOR,
indexvalue:APPDOWNLOAD
") 
TBLPROPERTIES ("hbase.table.name" = "t_video_develop_user_active_w");
grant select,delete,insert on t_video_develop_user_active_w_hbase to user mapred;
