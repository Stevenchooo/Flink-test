<dataFetchers>
    <hBaseFetcherGroup user="video/hadoop" keyTab="conf/video.keytab">
        <!-- 近日 platforimd 为all时-->
        <pageFetcher>
            <resultType>arrayMap</resultType>
            <name>develop_active_appversion_d</name>
            <from>t_video_develop_use_active_appversion_d</from>
            <rowKey>projectid@{projectid}#platformid@[0-9a-zA-Z:./-]*#appversioncode@[0-9a-zA-Z:./-]*#dtime@{dtime}#</rowKey>
            <indexKey>projectid@{projectid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}" />
            <filterField  name = "projectid" paramName="PROJECTID"  isKey="true"/>
            <filterField  name = "dtime" paramName="ENDTIME"  isKey="true"/>
            <resultField>
                platformid,appversioncode,appvernum,appverpercent,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format= "yyyyMMdd"/>
                <field name = "platformid" type = "string"/>
                <field name = "appversioncode" type = "string"/>
                <field name = "appvernum" type = "int"/>
                <field name = "appverpercent" type = "double" formula="APPVERPERCENT * 100.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>

        <!--  patformid有值时 -->
        <pageFetcher>
            <resultType>arrayMap</resultType>
            <name>develop_active_appversion_platformid_d</name>
            <from>t_video_develop_use_active_appversion_d</from>
            <rowKey>projectid@{projectid}#platformid@{platformid}#appversioncode@[0-9a-zA-Z:./-]*#dtime@{dtime}#</rowKey>
            <indexKey>projectid@{projectid}#platformid@{platformid}#dtime@{dtime}#</indexKey>
            <scope expression = "dtime = {ENDTIME}"/>
            <filterField name = "projectid" paramName="PROJECTID" isKey="true"/>
            <filterField name = "platformid" paramName="PLATFORMID" isKey="true"/>
            <filterField name = "dtime" paramName="ENDTIME" isKey="true"/>
            <resultField>
                platformid,appversioncode,appvernum,appverpercent,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format= "yyyyMMdd"/>
                <field name = "platformid" type = "string"/>
                <field name = "appversioncode" type = "string"/>
                <field name = "appvernum" type = "int"/>
                <field name = "appverpercent" type = "double" formula="APPVERPERCENT * 100.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </pageFetcher>
    </hBaseFetcherGroup>
</dataFetchers>