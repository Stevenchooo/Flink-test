<reportIndexGroup>
    <multiHqlReportIndexs>
        <!--  当期 客户端版本 版本号数量  appvernum-->
        <!--  当期 客户端版本 版本号占比=版本号数量/所有版本号数量 appverpercent -->

        <multiHqlReportIndex>
            <indexKey>video.develop.active.appversion.d</indexKey>
            <fieldName>appvernum,appverpercent</fieldName>
            <hql>
                <![CDATA[           
                 select projectid,platformid,appversioncode,date dtime,
                        cc appvernum,
		               (cc/total) appverpercent
                 from
				      (select distinct * 
				       from  
                            (select projectid,
                                    platformid,
                                    if(appversioncode is null,"none" ,appversioncode) appversioncode,
                                    date,
                                    count(*) over(partition by projectid,platformid,appversioncode,date)cc,
                                    count(*) over(partition by projectid,platformid,date) total
                            from video.t_cdr_sdk_event_join_video_user t
                            where t.date > '{STARTTIME}'
                            and t.date < '{ENDTIME}' 
							) tt
					  )ttt
                ]]>
            </hql>
        </multiHqlReportIndex>
    </multiHqlReportIndexs>
</reportIndexGroup>

