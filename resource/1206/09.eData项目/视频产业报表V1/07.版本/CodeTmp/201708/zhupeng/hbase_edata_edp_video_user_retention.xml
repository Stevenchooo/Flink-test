<dataFetchers>
    <hBaseFetcherGroup user="video/hadoop" keyTab="conf/video.keytab">
        
        <fetcher>
            <resultType>arrayMap</resultType>
            <name>user_retention_30d</name>
            <from>t_video_users_retention_d</from>
            <scope expression = "dtime between {ENDTIME} - 30 and {ENDTIME} - 1" />
            <keyField name = "projectid" paramName="PROJECTID"/>
            <keyField name = "activitychannelid" paramName="ACTIVITYCHANNELID"/>
			<keyField name = "platformid" paramName="PLATFORMID"/>
            <resultField>
             newsubscriber,day01retentionrate,day03retentionrate,day07retentionrate,day15retentionrate,day30retentionrate,avgday01retentionrate,avgday03retentionrate,avgday07retentionrate,avgday15retentionrate,avgday30retentionrate,dtime
            </resultField>
            <fieldDefinition>
                <field name = "dtime" type = "DATE" format = "yyyyMMdd"/>
                <field name = "newsubscriber" type = "int"/>
                <field name = "day01retentionrate" type = "double" formula="DAY01RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "day03retentionrate" type = "double" formula="DAY03RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "day07retentionrate" type = "double" formula="DAY07RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "day15retentionrate" type = "double" formula="DAY15RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "day30retentionrate" type = "double" formula="DAY30RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "avgday01retentionrate" type = "double" formula="AVGDAY01RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "avgday03retentionrate" type = "double" formula="AVGDAY03RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "avgday07retentionrate" type = "double" formula="AVGDAY07RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "avgday15retentionrate" type = "double" formula="AVGDAY15RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "avgday30retentionrate" type = "double" formula="AVGDAY30RETENTIONRATE * 100.00" format= "0.00"/>
                <field name = "{ENDTIME}" type = "DATE" format = "yyyyMMdd" />
            </fieldDefinition>
        </fetcher>

        
    </hBaseFetcherGroup>
</dataFetchers>