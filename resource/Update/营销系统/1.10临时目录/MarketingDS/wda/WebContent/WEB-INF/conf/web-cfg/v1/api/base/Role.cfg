{
"name": "角色定义",

"methods": [
    {
        "name":"/api/role/query",
        "type" : "AUTHRDB",
        
        "process" : {
            "sql" : "select * from t_ms_role"
        },
        
        "response" : {
            "results" : [
                {
                    "name" : "data",
                    "multi" : true,
                    "segments" : [
                        {"name":"role", "type":"STR", "desc":"角色"},
                        {"name":"name", "type":"STR", "desc":"角色名称"},
                        {"name":"description", "type":"STR", "desc":"角色描述"}
                    ]
                }
            ]
        }
    },

    {
        "name":"/api/role/rightQuery",
        "type" : "AUTHRDB",
        "sql": "none",
        "writeLog":false,
        "dataType":"role",
        "operation":"r",
        
        "process" : {
            "processor":"com.huawei.manager.base.api.RoleRightQuery",
            "sql":"select 1"
        }
    },

    {
        "name":"/api/role/rightSave",
        "type" : "AUTHRDB",
        "dataType":"role",
        "operation":"u",
        
        "types":[
            {
                "name":"Operation",
                "segments":[
                    {"name":"name", "type":"STR", "must":true, "min":1, "max":20, "desc":"操作名称 c|r|u|d"},
                    {"name":"val", "type":"BOOL", "must":true, "desc":"是否具有权限"}
                ]
            },
            
            {
                "name":"Right",
                "segments":[
                    {"name":"dataType", "type":"STR", "must":true, "min":1, "max":25, "desc":"元数据类型"},
                    {"name":"operations", "type":"ARRAY", "must":true, "min":1, "max":20, "object":"Operation", "desc":"可执行的操作"}
                ]
            }
        ],
        
        "request" : {
            "parameters" : [
                {"name":"role", "type":"STR", "must":true, "min":1, "max":25, "desc":"角色名称"},
                {"name":"rights", "type":"ARRAY", "must":true, "object":"Right", "desc":"具有的权限"}
            ]
        },
        
        "process" : {
            "sql": "insert into t_ms_right(role, meta, oprRight) values(?,?,?)",
            "processor":"com.huawei.manager.base.api.RoleRightSave"
        }
    },

    {
        "name":"/api/role/create",
        "type" : "AUTHRDB",
        "dataType":"role",
        "operation":"c",
        "authType":"user",
        
        "request" : {
            "parameters": [
                {"name":"role", "type":"STRING", "must":true, "min":1, "max":32, "desc":"角色，唯一"},
                {"name":"name", "type":"STRING", "must":true, "min":1, "max":50, "desc":"角色名称"},
                {"name":"description", "type":"STRING", "must":true, "default":"", "max":100, "desc":"角色描述"}
            ]
        },
        
        "process" : {
            "sql" : "{call sp_roleCreate(?, ?, ?, ?)}"
        }
    },
    
    {
        "name":"/api/role/modify",
        "type" : "AUTHRDB",
        "dataType":"role",
        "operation":"u",
        "authType":"user",
        "scopeId":"id",
        
        "request" : {
            "parameters": [
                {"name":"role", "type":"STRING", "must":true, "min":1, "max":32, "desc":"角色，唯一"},
                {"name":"name", "type":"STRING", "must":true, "min":1, "max":50, "desc":"角色名称"},
                {"name":"description", "type":"STRING", "max":100, "desc":"角色描述"}
            ]
        },
        
        "process" : {
            "sql" : "{call sp_roleModify(?, ?, ?, ?)}"
        }
    },
    
    {
        "name":"/api/role/detail",
        "type" : "AUTHRDB",
        "writeLog":false,
        "dataType":"role",
        "operation":"r",
        
        "request" : {
            "parameters": [
                {"name":"role", "type":"STRING", "must":true, "min":1, "max":32, "desc":"角色，唯一"}
            ]
        },
        
        "process" : {
            "sql" : "select role,name,description as 'desc' from t_ms_role where role=?"
        },
        
        "response" : {
            "results" : [
                {
                    "name" : "roles",
                    "merge" : true,
                    "segments" : [
                        {"name":"role", "type":"STR", "desc":"角色"},
                        {"name":"name", "type":"STR", "desc":"角色名称"},
                        {"name":"description", "type":"STR", "desc":"角色描述"}
                    ]
                }
            ]
        }
    },

    {
        "name":"/api/role/remove",
        "type" : "AUTHRDB",
        "dataType":"role",
        "operation":"d",
            
        "request" : {
            "parameters": [
                {"name":"role", "type":"STRING", "must":true, "min":1, "max":32, "desc":"角色，唯一"}
            ]
        },
        
        "process" : {
            "transaction":true,
            "sql" : "{call sp_roleRemove(?,?)}"
        }
    },
    
    {
     "name":"/api/role/queryByRole",
     "type":"AUTHRDB",
     "authType":"none",
     "writeLog":false,
     
     "request" : {
            "parameters" : [
                {"name":"role", "type":"STRING", "desc":""}
            ]
      },
     
     "process" : {
        "sql" : "select * from  t_ms_role where role = ?"
     },
     
     "response": {
       "results" : [
          {
	          "name" : "data",
	          "multi": false,
	          "segments" : [
                        {"name":"role", "type":"STR", "desc":"角色"},
                        {"name":"name", "type":"STR", "desc":"角色名称"},
                        {"name":"description", "type":"STR", "desc":"角色描述"}
              ]
          }
       ]
     }  
   },
   
   {
        "name":"/api/role/queryRoleRight",
        "type" : "AUTHRDB",
        "sql": "none",
        "writeLog":false,
        "dataType":"role",
        "operation":"r",
        
        "process" : {
            "processor":"com.huawei.manager.base.api.RoleRightQuery",
            "sql":"select 1"
        }
    },
   
   
   
]
}